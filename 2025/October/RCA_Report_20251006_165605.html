<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RCA Report - MoveInSync - Last 30 days</title>
    <style>
        body { font-family: -apple-system, Arial, sans-serif; margin: 0; background: #f8f9fa; }
        
        .header { 
            background: linear-gradient(135deg, #7c3aed 0%, #14b8a6 100%); 
            color: white; 
            padding: 25px 40px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 30px;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 25px;
        }
        
        .logo-text {
            font-size: 2rem;
            font-weight: bold;
            display: flex;
            align-items: baseline;
        }
        
        .logo-dot { color: #14b8a6; font-size: 2.5rem; margin: 0 2px; }
        .logo-cloud { color: #14b8a6; }
        
        .divider {
            width: 2px;
            height: 40px;
            background: rgba(255,255,255,0.3);
        }
        
        .report-title {
            font-size: 1.5rem;
            font-weight: 300;
        }
        
        .header-right { display: flex; align-items: center; gap: 40px; }
        .date-info { font-size: 0.95rem; opacity: 0.9; }
        .stats { display: flex; gap: 30px; }
        .stat { text-align: center; }
        .stat-number { font-size: 1.8rem; font-weight: bold; color: #14b8a6; }
        .stat-label { font-size: 0.75rem; opacity: 0.85; text-transform: uppercase; letter-spacing: 0.5px; margin-top: 2px; }
        
        .ai-badge {
            background: #10b981;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
            display: inline-block;
            margin-left: 10px;
        }
        
        .search-section {
            background: white;
            padding: 25px;
            margin: 30px auto;
            max-width: 1400px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .search-container { display: flex; gap: 15px; align-items: center; }
        .search-input { 
            flex: 1; 
            padding: 12px 20px; 
            border: 2px solid #e2e8f0; 
            border-radius: 8px; 
            font-size: 1rem; 
            outline: none; 
        }
        .search-input:focus { 
            border-color: #7c3aed; 
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1); 
        }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 0 20px 40px; }
        .customer-section { 
            background: white; 
            margin: 20px 0; 
            border-radius: 12px; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.08); 
            overflow: hidden; 
        }
        
        table { width: 100%; border-collapse: collapse; table-layout: auto; word-wrap: break-word; }
        th { 
            background: #fafafa; 
            padding: 12px 15px; 
            text-align: left; 
            font-size: 0.85rem; 
            color: #6b7280; 
            font-weight: 600; 
            text-transform: uppercase; 
            letter-spacing: 0.5px; 
        }
        td { 
            padding: 14px 15px; 
            border-bottom: 1px solid #f3f4f6; 
            color: #374151; 
        }
        
        tr.expandable { cursor: pointer; }
        tr.expandable:hover td { background: #f9fafb; }
        
        .expand-indicator { 
            display: inline-block; 
            margin-right: 8px; 
            transition: transform 0.3s; 
            color: #7c3aed; 
        }
        tr.expanded .expand-indicator { transform: rotate(90deg); }
        
        .status { 
            padding: 5px 10px; 
            border-radius: 6px; 
            font-size: 0.8rem; 
            font-weight: 500; 
        }
        .status-complete { background: #d1fae5; color: #065f46; }
        .status-open { background: #fef3c7; color: #92400e; }
        .status-progress { background: #dbeafe; color: #1e40af; }
        .status-default { background: #f3f4f6; color: #6b7280; }
        
        
        .ai-error-box {
            background: #fef2f2;
            border-left: 4px solid #ef4444;
            padding: 12px;
            margin-top: 8px;
            border-radius: 4px;
            font-size: 0.95rem;
        }
        
        .slack-indicator {
            display: inline-block;
            padding: 3px 8px;
            background: #4a1d96;
            color: white;
            border-radius: 4px;
            font-size: 0.75rem;
            margin-left: 8px;
        }
        
        /* Clean Code Block Styling */
        .code-block-wrapper {
            margin: 20px 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            background: #ffffff;
            max-width: 100%;
            width: 100%;
            box-sizing: border-box;
        }

        .code-header {
            background: linear-gradient(135deg, #374151 0%, #4b5563 100%);
            color: #f9fafb;
            padding: 12px 20px;
            font-size: 13px;
            font-weight: 600;
            letter-spacing: 0.5px;
            border-bottom: 1px solid #6b7280;
        }

        .code-block {
            margin: 0;
            padding: 20px;
            background: #1f2937;
            overflow: hidden;
            max-width: 100%;
            word-wrap: break-word;
            box-sizing: border-box;
        }

        .code-block code {
            color: #f3f4f6;
            font-family: 'SF Mono', 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.4;
            white-space: pre-wrap;
            word-break: break-all;
            overflow-wrap: break-word;
            display: block;
            max-width: 100%;
        }

        /* Clean Inline Code */
        .inline-code {
            background: #fef2f2;
            color: #dc2626;
            padding: 4px 8px;
            border-radius: 6px;
            font-family: 'SF Mono', 'Consolas', monospace;
            font-size: 0.9em;
            font-weight: 600;
            white-space: nowrap;
            border: 1px solid #fecaca;
        }

        /* Link Styles */
        .markdown-link {
            color: #2563eb;
            text-decoration: none;
            font-weight: 500;
            padding: 4px 8px;
            border-radius: 4px;
            background: #eff6ff;
            border: 1px solid #dbeafe;
            transition: all 0.2s;
            display: inline-block;
        }

        .markdown-link:hover {
            color: #1d4ed8;
            background: #dbeafe;
            border-color: #2563eb;
            transform: translateY(-1px);
        }

        .auto-link {
            color: #7c3aed;
            text-decoration: none;
            font-size: 0.95em;
            word-break: break-all;
            padding: 3px 6px;
            border-radius: 4px;
            background: #f3e8ff;
            border: 1px solid #d8b4fe;
        }

        .auto-link:hover {
            color: #5b21b6;
            background: #e9d5ff;
        }

        /* RCA Content Box */
        .rca-content-box {
            padding: 16px;
            background: #f0fdf4;
            border-left: 4px solid #10b981;
            border-radius: 8px;
            font-size: 0.95rem;
            line-height: 1.7;
            color: #1f2937;
            min-height: 60px;
        }

        .rca-content-box .code-block-wrapper {
            margin: 16px 0;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .rca-empty {
            color: #9ca3af;
            font-style: italic;
            padding: 20px;
            text-align: center;
            background: #f9fafb;
            border: 2px dashed #e5e7eb;
            border-radius: 6px;
        }

        /* Original pre styling for non-code blocks */
        pre {
            background: linear-gradient(135deg, #f8f9fa 0%, #f1f3f4 100%);
            border: 1px solid #d1d5db;
            border-left: 4px solid #7c3aed;
            border-radius: 8px;
            padding: 20px;
            margin: 16px 0;
            overflow-x: auto;
            font-size: 0.85rem;
            line-height: 1.5;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            position: relative;
        }
        
        /* Clean code blocks without content labels */
        
        code {
            font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', monospace;
            background: #e5e7eb;
            padding: 3px 6px;
            border-radius: 4px;
            font-size: 0.9em;
            color: #dc2626;
            font-weight: 500;
        }
        
        pre code {
            background: none;
            padding: 0;
            border-radius: 0;
            color: #1f2937;
            font-weight: 400;
            display: block;
            margin-top: 8px;
        }
        
        /* Enhanced syntax highlighting */
        .language-bash code,
        .language-shell code,
        .language-console code {
            color: #059669;
            font-weight: 500;
        }
        
        .language-log code,
        .language-text code {
            color: #374151;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .language-json code {
            color: #0891b2;
        }
        
        .language-yaml code,
        .language-yml code {
            color: #ea580c;
        }
        
        /* Download Button Styling */
        .download-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 10px;
        }

        .download-btn, .share-btn {
            background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px 16px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 120px;
        }

        .share-btn {
            background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(124, 58, 237, 0.4);
            background: linear-gradient(135deg, #6d28d9 0%, #9333ea 100%);
        }

        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
        }
        
        .download-icon {
            font-size: 1.1rem;
        }
        
        
        /* Comprehensive Print Styles for PDF Generation */
        @media print {
            /* Page setup for proper PDF sizing */
            @page {
                size: A4;
                margin: 10mm 15mm 10mm 15mm;
            }
            
            /* CRITICAL: Force all hidden content to show when printing */
            * {
                overflow: visible !important;
            }
            
            /* Reset body for print */
            body {
                margin: 0;
                padding: 0;
                font-size: 10pt !important;
                line-height: 1.3 !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                color-adjust: exact !important;
            }
            
            /* Scale down the entire content to fit */
            .header {
                padding: 15px 20px !important;
                page-break-after: avoid;
                break-after: avoid;
            }
            
            .header-content {
                max-width: 100% !important;
                font-size: 0.9em !important;
            }
            
            .logo-text {
                font-size: 1.3rem !important;
            }
            
            .report-title {
                font-size: 1.1rem !important;
            }
            
            .stat-number {
                font-size: 1.3rem !important;
            }
            
            /* Hide interactive elements */
            .download-container,
            .search-section {
                display: none !important;
            }
            
            /* Adjust container for print */
            .container {
                max-width: 100% !important;
                padding: 10px !important;
                margin: 0 !important;
            }
            
            /* Ensure tables fit on page */
            .customer-section {
                page-break-inside: avoid;
                break-inside: avoid;
                margin: 10px 0 !important;
            }
            
            table {
                width: 100% !important;
                font-size: 0.85em !important;
            }
            
            th, td {
                padding: 8px 10px !important;
                font-size: 0.85em !important;
            }
            
            /* Force all ticket details to be visible when printing */
            tr[id^="details_"] {
                display: table-row !important;
                visibility: visible !important;
                opacity: 1 !important;
                page-break-inside: avoid;
            }
            
            /* Override any inline styles */
            tr[style*="display: none"] {
                display: table-row !important;
            }
            
            /* Adjust expanded content for print */
            tr[id^="details_"] > td > div {
                padding: 15px 30px !important;
            }
            
            /* Make code blocks smaller but readable */
            pre {
                padding: 10px !important;
                margin: 8px 0 !important;
                font-size: 0.75em !important;
                page-break-inside: avoid;
                max-width: 100% !important;
                overflow: visible !important;
                white-space: pre-wrap !important;
                word-wrap: break-word !important;
            }
            
            pre code {
                font-size: 0.85em !important;
                white-space: pre-wrap !important;
                word-break: break-word !important;
            }
            
            /* Ensure all sections and content are visible */
            .expand-indicator {
                display: none !important;
            }
            
            /* Force all collapsed content to be visible */
            [style*="display: none"],
            [style*="display:none"] {
                display: block !important;
            }
            
            /* Ensure detail rows are visible */
            tr[id*="details"] {
                display: table-row !important;
            }
            
            /* Make sure all RCA content sections are visible */
            div[style*="background: #f9fafb"] {
                display: block !important;
                visibility: visible !important;
            }
            
            /* Adjust section headers */
            h2 {
                font-size: 1.2em !important;
                margin: 10px 0 !important;
                page-break-after: avoid;
            }
            
            h4 {
                font-size: 1em !important;
                margin: 8px 0 !important;
                page-break-after: avoid;
            }
            
            /* Ensure content boxes fit */
            div[style*="padding: 12px"] {
                padding: 8px !important;
                margin: 5px 0 !important;
            }
            
            /* Prevent page breaks in critical areas */
            .customer-section > div:first-child,
            .customer-section table {
                page-break-after: avoid;
            }
            
            /* Scale down any oversized content */
            * {
                max-width: 100% !important;
            }
            
            /* Ensure background colors print */
            .status,
            .ai-badge,
            pre {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
        }
        
        /* Special styling for error logs */
        pre:has(code:contains("error")),
        pre:has(code:contains("Error")),
        pre:has(code:contains("GRPC error")) {
            border-left-color: #dc2626;
            background: linear-gradient(135deg, #fef2f2 0%, #fef7f7 100%);
        }
        
        /* Removed error log labels */
        
        /* Special styling for mount/config logs */
        pre:has(code:contains("mount")),
        pre:has(code:contains("Mount")) {
            border-left-color: #f59e0b;
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
        }
        
        /* Removed mount log labels */
        
        /* Special styling for Java/JVM parameters */
        pre:has(code:contains("-server")),
        pre:has(code:contains("-Xms")) {
            border-left-color: #7c3aed;
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
        }
        
        /* Removed Java config labels */

        /* Image Viewer Modal Styles */
        .image-viewer-modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            cursor: pointer;
        }

        .image-viewer-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 95vw;
            max-height: 95vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .image-viewer-image {
            max-width: 100%;
            max-height: 85vh;
            object-fit: contain;
            border-radius: 8px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .image-viewer-title {
            color: white;
            background: rgba(0, 0, 0, 0.7);
            padding: 12px 20px;
            border-radius: 6px;
            margin-top: 15px;
            font-size: 1rem;
            font-weight: 500;
            text-align: center;
        }

        .image-viewer-close {
            position: absolute;
            top: 20px;
            right: 30px;
            color: white;
            font-size: 35px;
            font-weight: bold;
            cursor: pointer;
            z-index: 10001;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }

        .image-viewer-close:hover {
            background: rgba(0, 0, 0, 0.8);
        }

    </style>
</head>
<body>
    <!-- Download and Share Buttons -->
    <div class="download-container">
        <button class="download-btn" id="printBtn" title="Print / Save as PDF">
            <span class="download-icon">üñ®Ô∏è</span>
            <span>Print</span>
        </button>
        <button class="share-btn" id="shareReportBtn" title="Share Report Link">
            <span class="share-icon">üîó</span>
            <span>Share Link</span>
        </button>
    </div>

    <!-- Share Modal -->
    <div id="shareModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%;
                                background:rgba(0,0,0,0.5); z-index:10000;">
        <div style="background:white; border-radius:12px; padding:25px; max-width:500px;
                    width:90%; max-height:80vh; overflow:auto; position:fixed;
                    top:50%; left:50%; transform:translate(-50%, -50%);">
            <button id="closeModalBtn"
                    style="position:absolute; top:15px; right:15px; background:none;
                           border:none; font-size:24px; cursor:pointer; color:#6b7280;">√ó</button>
            <h3 style="margin:0 0 20px 0; color:#374151;">Share RCA Report</h3>

            <div style="margin-bottom:20px;">
                <label style="display:block; margin-bottom:8px; color:#6b7280; font-size:14px;">Report Link:</label>
                <div style="display:flex; gap:10px;">
                    <input id="shareUrl" type="text" readonly
                           style="flex:1; padding:10px; border:1px solid #e5e7eb; border-radius:6px;
                                  background:#f9fafb; font-family:monospace; font-size:13px;">
                    <button id="copyLinkBtn"
                            style="padding:10px 20px; background:#7c3aed; color:white;
                                   border:none; border-radius:6px; cursor:pointer;
                                   font-weight:500; white-space:nowrap;">
                        Copy Link
                    </button>
                </div>
                <div id="copySuccess" style="margin-top:10px; color:#10b981; font-size:14px; display:none;">
                    ‚úÖ Link copied to clipboard!
                </div>
            </div>

            <div style="margin-bottom:20px;">
                <label style="display:block; margin-bottom:12px; color:#6b7280; font-size:14px;">Quick Share:</label>
                <div style="display:grid; grid-template-columns:repeat(2, 1fr); gap:10px;">
                    <button id="shareEmailBtn"
                            style="padding:12px; background:#f3f4f6; border:1px solid #e5e7eb;
                                   border-radius:6px; cursor:pointer; display:flex; align-items:center;
                                   justify-content:center; gap:8px; transition:background 0.2s;">
                        <span>üìß</span> Email
                    </button>
                    <button id="shareSlackBtn"
                            style="padding:12px; background:#f3f4f6; border:1px solid #e5e7eb;
                                   border-radius:6px; cursor:pointer; display:flex; align-items:center;
                                   justify-content:center; gap:8px; transition:background 0.2s;">
                        <span>üí¨</span> Slack
                    </button>
                    <button id="shareTeamsBtn"
                            style="padding:12px; background:#f3f4f6; border:1px solid #e5e7eb;
                                   border-radius:6px; cursor:pointer; display:flex; align-items:center;
                                   justify-content:center; gap:8px; transition:background 0.2s;">
                        <span>üë•</span> Teams
                    </button>
                    <button id="shareWhatsAppBtn"
                            style="padding:12px; background:#f3f4f6; border:1px solid #e5e7eb;
                                   border-radius:6px; cursor:pointer; display:flex; align-items:center;
                                   justify-content:center; gap:8px; transition:background 0.2s;">
                        <span>üí¨</span> WhatsApp
                    </button>
                </div>
            </div>

            <div id="backupSection" style="margin-bottom:20px;">
                <label style="display:block; margin-bottom:8px; color:#6b7280; font-size:14px;">Alternative Link (HTML Preview):</label>
                <div style="display:flex; gap:10px;">
                    <input id="shareUrlBackup" type="text" readonly
                           style="flex:1; padding:10px; border:1px solid #e5e7eb; border-radius:6px;
                                  background:#f9fafb; font-family:monospace; font-size:13px;">
                    <button id="copyBackupLinkBtn"
                            style="padding:10px 20px; background:#059669; color:white;
                                   border:none; border-radius:6px; cursor:pointer;
                                   font-weight:500; white-space:nowrap;">
                        Copy Backup
                    </button>
                </div>
                <div style="margin-top:5px; color:#059669; font-size:12px;">
                    ‚úÖ This link works reliably for customer sharing
                </div>
            </div>

            <div style="padding:15px; background:#f0f9ff; border:1px solid #bae6fd;
                        border-radius:6px; margin-top:20px;">
                <p style="margin:0; color:#0369a1; font-size:14px; line-height:1.5;">
                    üí° <strong>Tip:</strong> This report can be opened directly in any browser.
                    The recipient will see the full interactive report with all features.
                </p>
            </div>
        </div>
    </div>

    <!-- Image Viewer Modal -->
    <div id="imageViewerModal" class="image-viewer-modal" onclick="closeImageViewer()">
        <div class="image-viewer-close" onclick="closeImageViewer()">&times;</div>
        <div class="image-viewer-content" onclick="event.stopPropagation()">
            <img id="imageViewerImage" class="image-viewer-image" src="" alt="">
            <div id="imageViewerTitle" class="image-viewer-title"></div>
        </div>
    </div>

    <div class="header">
        <div class="header-content">
            <div class="header-left">
                <div class="logo-section">
                    <div class="logo-text">
                        <span style="color: white;">Facets</span>
                        <span class="logo-dot">.</span>
                        <span class="logo-cloud">cloud</span>
                    </div>
                    <div class="divider"></div>
                    <div class="report-title">
                        RCA Report
                        <span class="ai-badge">‚ú® AI Enhanced</span>
                    </div>
                </div>
            </div>
            <div class="header-right">
                <div>
                    <div class="date-info">üìÖ Sep 06 - Oct 06, 2025</div>
                    <div class="date-info" style="margin-top: 5px;">MoveInSync - Last 30 days</div>
                </div>
                <div class="stats">
                    <div class="stat">
                        <div class="stat-number">10</div>
                        <div class="stat-label">Total Tickets</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number">1</div>
                        <div class="stat-label">Customers</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="search-section">
        <div class="search-container">
            <input type="text" class="search-input" id="searchInput"
                   placeholder="Search by ticket title, customer name, or status...">
            <button class="search-btn" id="searchBtn"
                    style="background: #7c3aed; color: white; padding: 12px 30px;
                           border: none; border-radius: 8px; cursor: pointer; margin: 0 5px;">
                üîç Search
            </button>
            <button class="clear-btn" id="clearBtn"
                    style="background: #dc2626; color: white; padding: 12px 30px;
                           border: none; border-radius: 8px; cursor: pointer; margin: 0 5px;">
                üîÑ Clear
            </button>
        </div>
    </div>
    
    <div class="container">
        <div class="customer-section">
            <div style="background: linear-gradient(135deg, #f8f9fa 0%, #f3f4f6 100%); 
                        padding: 20px 25px; display: flex; justify-content: space-between; align-items: center;">
                <h2>MoveInSync</h2>
                <span style="background: #14b8a6; color: white; padding: 6px 14px; 
                           border-radius: 20px; font-size: 0.85rem; font-weight: 500;">
                    10 tickets
                </span>
            </div>
            <table>
                <tr>
                    <th width="50">#</th>
                    <th>Title</th>
                    <th width="120">ClickUp</th>
                    <th width="100">Date</th>
                    <th width="120">Status</th>
                    <th width="150">Owner</th>
                </tr>
                <tr class="expandable" data-ticket-id="MoveInSync_1">
                    <td><span class="expand-indicator">‚ñ∂</span> 1</td>
                    <td>ingress path support "path": "*efmfm*",<span class="slack-indicator">Slack Thread</span></td>
                    <td><a href="https://app.clickup.com/t/86d0haawh" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-10-06</td>
                    <td><span class="status status-default">customer side fix</span></td>
                    <td>Rauneet Verma</td>
                </tr>
                <tr id="details_MoveInSync_1" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>MoveInSync</div>
                                <div><strong>Date:</strong><br>2025-10-06</div>
                                <div><strong>Status:</strong><br>customer side fix</div>
                                <div><strong>Owner:</strong><br>Rauneet Verma</div>
                                <div><strong>ClickUp ID:</strong><br>86d0haawh</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, MoveInSync, was attempting to configure an ingress path with the pattern "*efmfm*". The expected outcome was for the ingress to correctly interpret and apply this path configuration. However, there was an issue with the configuration that required clarification or adjustment. The environment involved was likely related to a Kubernetes setup, given the context of ingress paths. The impact was that the desired path configuration was not functioning as intended, prompting the customer to seek support. The ticket status indicates that the resolution was to be handled on the customer side, with guidance provided by the support team.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Rauneet Verma acknowledged the issue and indicated that it was resolved, suggesting that the problem might have been identified and addressed internally or that guidance was provided to the customer. The exact nature of the resolution was not detailed in the conversation.<br><br>

2. Azad Tomar requested clarification on the ingress path configuration, specifically highlighting the path pattern as "*efmfm*". This suggests that the team was verifying the correctness of the path configuration or seeking confirmation from the customer.<br><br>

3. Rauneet Verma instructed the customer to test the configuration and report back, indicating that the team believed the issue might be resolved or that further testing was needed to confirm the fix. This step implies that the team had made some adjustments or provided instructions for the customer to follow.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. The customer was advised to test the ingress path configuration with the specified pattern "*efmfm*". This step was crucial to verify if the configuration changes or guidance provided resolved the issue.<br><br>

2. Rauneet Verma confirmed that the issue was resolved, suggesting that the customer either implemented the recommended changes or that the initial configuration was correct but required validation. The resolution was marked as a customer-side fix, indicating that the customer was responsible for applying the final changes or testing the configuration.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The likely root cause of the issue was related to the configuration of the ingress path with the pattern "*efmfm*". It appears that there was either a misunderstanding or misconfiguration that needed clarification. The support team provided guidance, and the customer was responsible for implementing the fix. The resolution suggests that the issue was not with the system itself but rather with the configuration or understanding of how to apply the path pattern correctly. Further investigation or testing by the customer was necessary to confirm the resolution.<br><br>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="MoveInSync_2">
                    <td><span class="expand-indicator">‚ñ∂</span> 2</td>
                    <td>Header issue in private NLB</td>
                    <td><a href="https://app.clickup.com/t/86d0fjff3" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-30</td>
                    <td><span class="status status-default">needs customer response</span></td>
                    <td>Omendra Tomar</td>
                </tr>
                <tr id="details_MoveInSync_2" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>MoveInSync</div>
                                <div><strong>Date:</strong><br>2025-09-30</div>
                                <div><strong>Status:</strong><br>needs customer response</div>
                                <div><strong>Owner:</strong><br>Omendra Tomar</div>
                                <div><strong>ClickUp ID:</strong><br>86d0fjff3</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, MoveInSync, was experiencing an issue where the <code class="inline-code">CSRF_NONCE</code> header was not being passed through their private Network Load Balancer (NLB) to the <code class="inline-code">routeeditor</code> service in the <code class="inline-code">mis-prod-sg</code> environment. This was unexpected as the header should have been transmitted without issue. The problem was identified as being caused by the NGINX ingress controller's default behavior of dropping HTTP headers containing underscores, which was not configured to allow such headers in the current setup. This misconfiguration led to the header being silently dropped, impacting the service's functionality.<br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Dhvani Vashist confirmed the environment and service details:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>env: mis-prod-sg
   service name: routeeditor<br>
   ingress: moveinsync-nlb-pvt</code></pre><br>
</div>
   This provided the necessary context for further investigation.<br><br>

2. Omendra Tomar identified the root cause by examining the NGINX ingress controller configuration. He noted that the <code class="inline-code">enable-underscores-in-headers</code> setting was incorrectly set to <code class="inline-code">false</code> in the JSON configuration at the spec level:<br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>&quot;nginx_ingress_controller&quot;: {
   &quot;enable-underscores-in-headers&quot;: false<br>
   }</code></pre><br>
</div>
   This setting was causing the <code class="inline-code">CSRF_NONCE</code> header to be dropped.<br>

3. Omendra suggested moving the configuration to the advanced block to enable underscores in headers:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù JSON</div>
<pre class="code-block"><code>{
     &quot;advanced&quot;: {<br>
       &quot;nginx_ingress_controller&quot;: {<br>
         &quot;enable-underscores-in-headers&quot;: true<br>
       }<br>
     }<br>
   }</code></pre><br>
</div>
   This change was necessary to allow the header to pass through the NLB.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. Umer Beigh implemented the suggested configuration change by adding the <code class="inline-code">enable-underscores-in-headers</code> setting to the advanced block of the NGINX ingress controller configuration:<br>
   <div class="code-block-wrapper">
<div class="code-header">üìù JSON</div>
<pre class="code-block"><code>{
     &quot;advanced&quot;: {<br>
       &quot;nginx_ingress_controller&quot;: {<br>
         &quot;enable-underscores-in-headers&quot;: true<br>
       }<br>
     }<br>
   }</code></pre><br>
</div>
   This was done to ensure that headers with underscores are not dropped.<br><br>

2. Omendra Tomar confirmed that the configuration change was successful. The <code class="inline-code">CSRF_NONCE</code> header was now visible in the pod logs, indicating that the issue was resolved:<br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>header is also visible in the pod logs.</code></pre>
</div>
   This verification step confirmed that the header was being correctly passed through the NLB.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The issue was caused by the NGINX ingress controller's default behavior of dropping HTTP headers containing underscores. The configuration for <code class="inline-code">enable-underscores-in-headers</code> was incorrectly set to <code class="inline-code">false</code>, which led to the <code class="inline-code">CSRF_NONCE</code> header being dropped before reaching the <code class="inline-code">routeeditor</code> service. This misconfiguration was identified by examining the ingress controller settings and was resolved by moving the configuration to the advanced block, allowing headers with underscores to pass through. Further investigation confirmed the header was visible in the pod logs, indicating successful resolution.<br>
                                </div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìé ClickUp Attachments & Screenshots</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin: 15px 0;">
                                    <div style="border: 2px solid #e5e7eb; border-radius: 8px; overflow: hidden; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <img src="https://t3443930.p.clickup-attachments.com/t3443930/eac4ab33-453b-48a6-9cd4-6dc788ef4876/image.png" alt="image.png" style="width: 100%; height: 200px; object-fit: cover; cursor: pointer;" onclick="openImageViewer('https://t3443930.p.clickup-attachments.com/t3443930/eac4ab33-453b-48a6-9cd4-6dc788ef4876/image.png', 'image.png')">
                                        <div style="padding: 12px; background: #f9fafb; border-top: 1px solid #e5e7eb;">
                                            <div style="font-weight: 600; color: #374151; margin-bottom: 4px;">image.png</div>
                                            <a href="https://t3443930.p.clickup-attachments.com/t3443930/eac4ab33-453b-48a6-9cd4-6dc788ef4876/image.png" target="_blank" style="color: #7c3aed; text-decoration: none; font-size: 0.85rem;">View Full Size ‚Üí</a>
                                        </div>
                                    </div>
                                    <div style="border: 2px solid #e5e7eb; border-radius: 8px; overflow: hidden; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <img src="https://t3443930.p.clickup-attachments.com/t3443930/c50fc83c-37e9-4f3e-8dfd-b78cd4adf6d6/image.png" alt="image.png" style="width: 100%; height: 200px; object-fit: cover; cursor: pointer;" onclick="openImageViewer('https://t3443930.p.clickup-attachments.com/t3443930/c50fc83c-37e9-4f3e-8dfd-b78cd4adf6d6/image.png', 'image.png')">
                                        <div style="padding: 12px; background: #f9fafb; border-top: 1px solid #e5e7eb;">
                                            <div style="font-weight: 600; color: #374151; margin-bottom: 4px;">image.png</div>
                                            <a href="https://t3443930.p.clickup-attachments.com/t3443930/c50fc83c-37e9-4f3e-8dfd-b78cd4adf6d6/image.png" target="_blank" style="color: #7c3aed; text-decoration: none; font-size: 0.85rem;">View Full Size ‚Üí</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="MoveInSync_3">
                    <td><span class="expand-indicator">‚ñ∂</span> 3</td>
                    <td>Getting error in ebs csi driver pod on node in dev env</td>
                    <td><a href="https://app.clickup.com/t/86d0f2xxe" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-29</td>
                    <td><span class="status status-default">customer side fix</span></td>
                    <td>Rauneet Verma</td>
                </tr>
                <tr id="details_MoveInSync_3" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>MoveInSync</div>
                                <div><strong>Date:</strong><br>2025-09-29</div>
                                <div><strong>Status:</strong><br>customer side fix</div>
                                <div><strong>Owner:</strong><br>Rauneet Verma</div>
                                <div><strong>ClickUp ID:</strong><br>86d0f2xxe</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, MoveInSync, encountered an issue with the EBS CSI driver pod on a node in their development environment. They were attempting to ensure that the EBS CSI controller pods were running correctly. However, the pods were in a pending state due to scheduling issues caused by node taints and volume attachment failures. The environment involved Kubernetes nodes managed by Cast AI, which had added taints that the EBS CSI controller pods could not tolerate, leading to unschedulable nodes and volume attachment timeouts.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Umer Beigh observed the following scheduling and attachment issues in the Kubernetes events:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>Warning  FailedScheduling    15m (x17 over 95m)  default-scheduler        0/5 nodes are available: 1 node(s) had untolerated taint {facets.cloud/dedicated: true}, 4 node(s) were unschedulable. preemption: 0/5 nodes are available: 5 Preemption is not helpful for scheduling.
   Warning  FailedScheduling    10m (x3 over 10m)   default-scheduler        0/6 nodes are available: 1 node(s) had untolerated taint {facets.cloud/dedicated: true}, 1 node(s) had volume node affinity conflict, 4 node(s) were unschedulable. preemption: 0/6 nodes are available: 6 Preemption is not helpful for scheduling.<br>
   Warning  FailedAttachVolume  2s (x5 over 8m10s)  attachdetach-controller  AttachVolume.Attach failed for volume &quot;pvc-8eff36fe-ce79-49f0-b67e-b1fee15d2e3d&quot; : timed out waiting for external-attacher of ebs.csi.aws.com CSI driver to attach volume vol-02d2681f86b077883</code></pre><br>
</div>
   This indicated that the nodes were either tainted or had volume node affinity conflicts, preventing the pods from being scheduled.<br><br>

2. Rauneet Verma identified that Cast AI had added a taint on the nodes:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>Cast AI has added the taint on the nodes</code></pre>
</div>
   This taint was preventing the EBS CSI controller pods from being scheduled as they lacked the necessary tolerations.<br><br>

3. Umer Beigh removed the taints from the nodes to allow the pods to be scheduled.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. Umer Beigh removed the taints added by Cast AI from the nodes, which were preventing the EBS CSI controller pods from being scheduled. This action was necessary to resolve the scheduling conflict caused by the taints.<br><br>

2. After the taints were removed, Rauneet Verma confirmed that the EBS CSI controller pods were running successfully:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>kube-system        ebs-csi-controller-8664f544d6-dw8lg                               7/7     Running             2 (15m ago)     3h5m
   kube-system        ebs-csi-controller-8664f544d6-f7942                               7/7     Running             1 (29m ago)     3h5m</code></pre><br>
</div>
   This confirmed that the pods were now able to run without the taint-related scheduling issues.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The issue was primarily caused by taints added by Cast AI on the Kubernetes nodes, which the EBS CSI controller pods could not tolerate. These taints prevented the pods from being scheduled, leading to a pending state. Additionally, there was a volume attachment failure due to a timeout waiting for the external-attacher of the EBS CSI driver. The removal of these taints allowed the pods to be scheduled and run successfully. Further investigation into why Cast AI added these taints and ensuring proper tolerations for critical pods could prevent similar issues in the future.<br><br>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="MoveInSync_4">
                    <td><span class="expand-indicator">‚ñ∂</span> 4</td>
                    <td>mis-prod-sg  prometheus down</td>
                    <td><a href="https://app.clickup.com/t/86d0d1799" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-22</td>
                    <td><span class="status status-default">customer side fix</span></td>
                    <td>Rauneet Verma</td>
                </tr>
                <tr id="details_MoveInSync_4" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>MoveInSync</div>
                                <div><strong>Date:</strong><br>2025-09-22</div>
                                <div><strong>Status:</strong><br>customer side fix</div>
                                <div><strong>Owner:</strong><br>Rauneet Verma</div>
                                <div><strong>ClickUp ID:</strong><br>86d0d1799</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, MoveInSync, reported an issue with their Prometheus instance in the mis-prod-sg environment, which was down due to resource constraints. The expected behavior was for Prometheus to run smoothly, but it was being terminated with an OOMKilled error while trying to load Write-Ahead Log (WAL) files. This was due to the instance type <code class="inline-code">m5a.2xlarge</code> not having sufficient CPU and memory resources to handle the large WAL files. The impact was a disruption in monitoring capabilities, as Prometheus was unable to start properly.<br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Rauneet Verma observed that the Prometheus instance was being OOMKilled due to large WAL files. This was confirmed by examining the logs which showed repeated OOMKilled errors:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>I can see that it is getting OOMKilled while trying to load the WAL files since WAL file is very huge.
   Last State:  Terminated<br>
   Reason:    OOMKilled<br>
   Message:   :24:34.527Z caller=head.go:683 level=info component=tsdb msg=&quot;WAL segment loaded&quot; segment=35919 maxSegment=36317</code></pre><br>
</div>

2. Rauneet noted that the current instance type, <code class="inline-code">m5a.2xlarge</code>, lacked sufficient CPU and memory to load the WAL files completely:<br>
   <div class="code-block-wrapper">
<div class="code-header">üìù BASH</div>
<pre class="code-block"><code>which does not have sufficient amount of cpu and memory to completely load the WAL files.</code></pre>
</div>

3. K Harshavardhan provided context by noting the last alert was triggered on September 19 at 23:52, indicating the issue had been ongoing:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>last alert  triggered on Sep 19 23:52</code></pre>
</div>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. Rauneet Verma suggested increasing the instance size to provide more CPU and memory resources to handle the large WAL files. This was a temporary measure to ensure Prometheus could load the WAL files without being OOMKilled.<br><br>

2. Umer Beigh confirmed that Prometheus was back up after the instance type was changed, indicating that the increased resources allowed the WAL files to be loaded successfully. He then asked K Harshavardhan to verify the status:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>prometheus is up now</code></pre>
</div>

3. K Harshavardhan was asked to check the status to ensure that the issue was resolved from the customer's perspective, confirming the effectiveness of the resolution.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The likely root cause of the issue was the insufficient CPU and memory resources of the <code class="inline-code">m5a.2xlarge</code> instance type, which could not handle the large size of the WAL files in Prometheus. This led to the instance being repeatedly OOMKilled. The problem was identified through log analysis, which showed the termination reason as OOMKilled due to the inability to load WAL segments. Increasing the instance size provided the necessary resources to resolve the issue, allowing Prometheus to start and operate normally. Further investigation into WAL file management and instance sizing may be needed to prevent recurrence.<br>
                                </div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìé ClickUp Attachments & Screenshots</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin: 15px 0;">
                                    <div style="border: 2px solid #e5e7eb; border-radius: 8px; overflow: hidden; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <img src="https://t3443930.p.clickup-attachments.com/t3443930/40a2c70e-9d77-439c-b961-281b39852660/image.png" alt="image.png" style="width: 100%; height: 200px; object-fit: cover; cursor: pointer;" onclick="openImageViewer('https://t3443930.p.clickup-attachments.com/t3443930/40a2c70e-9d77-439c-b961-281b39852660/image.png', 'image.png')">
                                        <div style="padding: 12px; background: #f9fafb; border-top: 1px solid #e5e7eb;">
                                            <div style="font-weight: 600; color: #374151; margin-bottom: 4px;">image.png</div>
                                            <a href="https://t3443930.p.clickup-attachments.com/t3443930/40a2c70e-9d77-439c-b961-281b39852660/image.png" target="_blank" style="color: #7c3aed; text-decoration: none; font-size: 0.85rem;">View Full Size ‚Üí</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="MoveInSync_5">
                    <td><span class="expand-indicator">‚ñ∂</span> 5</td>
                    <td>add s3 vpc endpoint for prod mumbai region</td>
                    <td><a href="https://app.clickup.com/t/86d0ccv5t" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-19</td>
                    <td><span class="status status-default">in qa</span></td>
                    <td>Debarshi Mullick</td>
                </tr>
                <tr id="details_MoveInSync_5" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>MoveInSync</div>
                                <div><strong>Date:</strong><br>2025-09-19</div>
                                <div><strong>Status:</strong><br>in qa</div>
                                <div><strong>Owner:</strong><br>Debarshi Mullick</div>
                                <div><strong>ClickUp ID:</strong><br>86d0ccv5t</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, MoveInSync, requested the addition of an S3 VPC endpoint for their production environment in the Mumbai region. The expectation was that the S3 VPC endpoint would be automatically created by the Infrastructure as Code (IAC) process. However, it was discovered that the endpoint was not present in the route tables, which led to connectivity issues. Additionally, there was a need to create a VPC endpoint for DynamoDB. The environment involved was the production setup in the Mumbai region, and the issue was marked as urgent due to its impact on operations.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Debarshi Mullick noted that the S3 VPC endpoint should have been created by default through the IAC process. This was confirmed in a comment directed to Umer Beigh.<br><br>

2. Dhvani Vashist identified that the S3 VPC endpoint was missing from the route tables, which was a critical oversight. This was communicated to Azad Tomar for further action.<br><br>

3. Umer Beigh suggested that the missing route table association needed to be addressed to resolve the issue. This was a key step in diagnosing the connectivity problem.<br><br>

4. Azad Tomar confirmed that the manual completion of the S3 VPC endpoint and DynamoDB association was necessary. The associations were made with the route tables <code class="inline-code">mis-prod-mum-vpc-private</code> and <code class="inline-code">mis-prod-mum-vpc-public</code> for DynamoDB, and <code class="inline-code">mis-prod-mum-vpc-private</code> for the S3 VPC endpoint.<br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. Azad Tomar manually completed the association of the S3 VPC endpoint with the route table <code class="inline-code">mis-prod-mum-vpc-private</code>. This step was crucial to ensure that the S3 service could be accessed within the VPC.<br>

2. Additionally, Azad Tomar manually associated the DynamoDB VPC endpoint with both <code class="inline-code">mis-prod-mum-vpc-private</code> and <code class="inline-code">mis-prod-mum-vpc-public</code> route tables. This ensured that DynamoDB services were accessible from both private and public subnets within the VPC.<br>

3. The manual associations were verified to ensure that the endpoints were correctly configured and operational within the production environment.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The issue appears to have been caused by the absence of the S3 VPC endpoint in the route tables, which was expected to be automatically handled by the IAC process. However, this automatic creation did not occur, leading to connectivity issues. The manual intervention by Azad Tomar to associate the endpoints with the appropriate route tables resolved the issue. Further investigation into the IAC process is needed to ensure that such endpoints are automatically created and associated in the future to prevent similar issues.<br><br>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="MoveInSync_6">
                    <td><span class="expand-indicator">‚ñ∂</span> 6</td>
                    <td>Increase the retention period for prometheus and process to create recording rules</td>
                    <td><a href="https://app.clickup.com/t/86d0cahgr" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-19</td>
                    <td><span class="status status-default">needs customer response</span></td>
                    <td>Debarshi Mullick</td>
                </tr>
                <tr id="details_MoveInSync_6" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>MoveInSync</div>
                                <div><strong>Date:</strong><br>2025-09-19</div>
                                <div><strong>Status:</strong><br>needs customer response</div>
                                <div><strong>Owner:</strong><br>Debarshi Mullick</div>
                                <div><strong>ClickUp ID:</strong><br>86d0cahgr</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, MoveInSync, aimed to extend the retention period for Prometheus data from 7 days to 30 days across multiple environments, including mis-prod-sg, mis-prod-mum, and mis-prod-eu. The expected outcome was a successful configuration update to retain data for a longer period, but the customer also requested guidance on creating recording rules for Loki. The technical team, led by Debarshi Mullick, provided JSON configuration changes to achieve the desired retention period and outlined the process for setting up Loki recording rules. The impact of this change was to ensure longer data retention for monitoring purposes, which is critical for maintaining operational insights.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Debarshi Mullick initiated the investigation by examining the current Prometheus configuration to identify the retention period setting. He proposed a JSON configuration update to extend the retention period:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù JSON</div>
<pre class="code-block"><code>{
     &quot;advanced&quot;: {<br>
       &quot;kube_prometheus_stack&quot;: {<br>
         &quot;values&quot;: {<br>
           &quot;prometheus&quot;: {<br>
             &quot;prometheusSpec&quot;: {<br>
               &quot;retention&quot;: &quot;30d&quot;<br>
             }<br>
           }<br>
         }<br>
       }<br>
     }<br>
   }</code></pre><br>
</div>
   This configuration was intended to change the retention period from 7 days to 30 days.<br><br>

2. K Harshavardhan verified the implementation of the retention period change across the specified environments (mis-prod-sg, mis-prod-mum, mis-prod-eu) and confirmed the update was applied.<br><br>

3. Debarshi Mullick provided further instructions on creating Loki recording rules by specifying the JSON path and structure required for the configuration:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>For creating the loki recording rules, need to add the resource loki_recording_rules to your blueprint. The resource can be created by adding a JSON to the path-
   loki_recording_rules/instances/example.json</code></pre><br>
</div>
   This step was crucial for setting up the recording rules as per the customer's request.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. Debarshi Mullick provided the JSON configuration to increase the Prometheus retention period, which was implemented as follows:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù JSON</div>
<pre class="code-block"><code>{
     &quot;advanced&quot;: {<br>
       &quot;kube_prometheus_stack&quot;: {<br>
         &quot;values&quot;: {<br>
           &quot;prometheus&quot;: {<br>
             &quot;prometheusSpec&quot;: {<br>
               &quot;retention&quot;: &quot;30d&quot;<br>
             }<br>
           }<br>
         }<br>
       }<br>
     }<br>
   }</code></pre><br>
</div>
   This change was confirmed by K Harshavardhan across the specified environments.<br><br>

2. For the creation of Loki recording rules, Debarshi Mullick outlined the necessary JSON structure and path:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>loki_recording_rules/instances/example.json</code></pre>
</div>
   He provided a sample JSON configuration to guide the customer in setting up their own expressions:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù JSON</div>
<pre class="code-block"><code>{
     &quot;kind&quot;: &quot;loki_recording_rules&quot;,<br>
     &quot;flavor&quot;: &quot;k8s&quot;,<br>
     &quot;version&quot;: &quot;0.1&quot;,<br>
     &quot;disabled&quot;: true,<br>
     &quot;lifecycle&quot;: &quot;ENVIRONMENT&quot;,<br>
     &quot;metadata&quot;: {<br>
       &quot;name&quot;: &quot;sample-loki-log-recording&quot;<br>
     },<br>
     &quot;depends_on&quot;: [],<br>
     &quot;spec&quot;: {<br>
       &quot;rules&quot;: {<br>
         &quot;flog:requests:rate1m&quot;: {<br>
           &quot;expr&quot;: &quot;sum(rate({app=\&quot;flog\&quot;} | json[1m])) by (app, pod, job)&quot;,<br>
           &quot;disabled&quot;: false,<br>
           &quot;labels&quot;: {<br>
             &quot;cluster&quot;: &quot;infra-dev&quot;<br>
           }<br>
         },<br>
         &quot;flog:requests:rate5m&quot;: {<br>
           &quot;expr&quot;: &quot;sum(rate({app=\&quot;flog\&quot;} | json[5m])) by (app, pod, job)&quot;,<br>
           &quot;disabled&quot;: false,<br>
           &quot;labels&quot;: {<br>
             &quot;cluster&quot;: &quot;infra-dev&quot;<br>
           }<br>
         }<br>
       }<br>
     },<br>
     &quot;advanced&quot;: {},<br>
     &quot;out&quot;: {}<br>
   }</code></pre><br>
</div>
   This configuration was intended to help the customer create and manage recording rules effectively.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The issue primarily involved the need to update the Prometheus configuration to extend the data retention period from 7 days to 30 days, which was successfully achieved through a JSON configuration update. The secondary requirement was to establish a process for creating Loki recording rules, which was addressed by providing a detailed JSON template and path for implementation. The root cause of the initial configuration limitation was the default retention setting in Prometheus, which did not meet the customer's extended data retention needs. The guidance provided ensured that both the retention period and recording rules could be configured as per the customer's requirements.<br><br>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="MoveInSync_7">
                    <td><span class="expand-indicator">‚ñ∂</span> 7</td>
                    <td>consul pod not coming up due to volume attach error</td>
                    <td><a href="https://app.clickup.com/t/86d09vr30" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-12</td>
                    <td><span class="status status-default">customer side fix</span></td>
                    <td>Debarshi Mullick</td>
                </tr>
                <tr id="details_MoveInSync_7" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>MoveInSync</div>
                                <div><strong>Date:</strong><br>2025-09-12</div>
                                <div><strong>Status:</strong><br>customer side fix</div>
                                <div><strong>Owner:</strong><br>Debarshi Mullick</div>
                                <div><strong>ClickUp ID:</strong><br>86d09vr30</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, MoveInSync, was experiencing an issue where a Consul pod was not starting due to a volume attachment error in their development environment. The expected behavior was for the pod to start successfully, allowing all services to run smoothly. However, the actual outcome was that the pod failed to start, impacting all services dependent on it. The error was linked to the EBS driver not initializing on the node where the pod was scheduled. This issue was critical as it affected the availability of services in the development environment.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. **Debarshi Mullick** initiated the investigation by acknowledging the issue and starting to look into the problem.<br><br>

2. **Umer Beigh** identified that the issue was occurring in the development environment and noted that all services were down, prompting an urgent check.<br><br>

3. **Umer Beigh** discovered that the EBS driver was not starting on the node where the pod was scheduled. This was a critical finding as it directly related to the volume attachment error preventing the pod from coming up:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>FYI the node where pod is getting schedule there ebs driver is not getting up</code></pre>
</div>

4. **Debarshi Mullick** observed that the Datafy Helm chart had injected custom values into the DaemonSet configuration of the EBS CSI pods. This modification was suspected to be causing the issue, leading to a decision to reset the deployment to its original state.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. **Debarshi Mullick** performed a reset of the deployment to revert the DaemonSet configuration of the EBS CSI pods to its original state. This action was intended to remove the custom values injected by the Datafy Helm chart and restore the previous configuration.<br><br>

2. The reset aimed to ensure that the EBS driver could initialize correctly on the node, allowing the Consul pod to start successfully and restore service availability in the development environment.<br><br>

3. The customer was advised to monitor the environment post-reset to confirm that the issue was resolved and that the services were back online. Since the ticket status is marked as "customer side fix," it indicates that the customer was provided guidance to manage the resolution on their end.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The likely root cause of the issue was the injection of custom values into the DaemonSet configuration of the EBS CSI pods by the Datafy Helm chart. This modification appears to have prevented the EBS driver from initializing on the node where the Consul pod was scheduled, leading to the volume attachment error. The issue was identified through the observation that the EBS driver was not coming up, and the resolution involved reverting the deployment to its original configuration. Further investigation may be needed to confirm the exact impact of the custom values on the EBS driver's initialization process.<br><br>
                                </div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìé ClickUp Attachments & Screenshots</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin: 15px 0;">
                                    <div style="border: 2px solid #e5e7eb; border-radius: 8px; overflow: hidden; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <img src="https://t3443930.p.clickup-attachments.com/t3443930/5ad48766-d43e-40a1-bdcf-62a34ccab968/image.png" alt="image.png" style="width: 100%; height: 200px; object-fit: cover; cursor: pointer;" onclick="openImageViewer('https://t3443930.p.clickup-attachments.com/t3443930/5ad48766-d43e-40a1-bdcf-62a34ccab968/image.png', 'image.png')">
                                        <div style="padding: 12px; background: #f9fafb; border-top: 1px solid #e5e7eb;">
                                            <div style="font-weight: 600; color: #374151; margin-bottom: 4px;">image.png</div>
                                            <a href="https://t3443930.p.clickup-attachments.com/t3443930/5ad48766-d43e-40a1-bdcf-62a34ccab968/image.png" target="_blank" style="color: #7c3aed; text-decoration: none; font-size: 0.85rem;">View Full Size ‚Üí</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="MoveInSync_8">
                    <td><span class="expand-indicator">‚ñ∂</span> 8</td>
                    <td>Unable to attach EFS to pod</td>
                    <td><a href="https://app.clickup.com/t/86d09jha0" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-11</td>
                    <td><span class="status status-default">customer side fix</span></td>
                    <td>Rauneet Verma</td>
                </tr>
                <tr id="details_MoveInSync_8" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>MoveInSync</div>
                                <div><strong>Date:</strong><br>2025-09-11</div>
                                <div><strong>Status:</strong><br>customer side fix</div>
                                <div><strong>Owner:</strong><br>Rauneet Verma</div>
                                <div><strong>ClickUp ID:</strong><br>86d09jha0</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, MoveInSync, was attempting to attach an Amazon EFS to a Kubernetes pod within their EKS cluster. The expected outcome was for the EFS to mount successfully, allowing the pod to access the file system. However, the actual result was a failure to mount the EFS, with the pods entering a <code class="inline-code">CrashLoopBackOff</code> state. The error logs indicated issues with the EFS CSI driver and configuration warnings related to the EFS utilities. This issue was critical as it impacted the deployment of the <code class="inline-code">mis-healthlogs</code> service in the production environment.<br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Rauneet Verma observed the initial error logs indicating a GRPC error related to mounting the EFS:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù BASH</div>
<pre class="code-block"><code>E0911 12:34:25.781867       1 driver.go:107] GRPC error: rpc error: code = Internal desc = Could not mount &quot;fs-079fbe5bbe7a6b2cf:/&quot; at &quot;/var/lib/kubelet/pods/b352cf58-adc1-4e3f-a02b-eb8633a834d4/volumes/kubernetes.io~csi/healthlog-service-pv/mount&quot;: mount failed: exit status 32</code></pre>
</div>
   This indicated a failure in the mounting process due to an internal error.<br><br>

2. The mounting command and arguments were reviewed:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù BASH</div>
<pre class="code-block"><code>Mounting arguments: -t efs -o tls fs-079fbe5bbe7a6b2cf:/ /var/lib/kubelet/pods/b352cf58-adc1-4e3f-a02b-eb8633a834d4/volumes/kubernetes.io~csi/healthlog-service-pv/mount</code></pre>
</div>
   The output showed issues with the <code class="inline-code">amazon-efs-mount-watchdog</code> and unrecognized init system:<br>
   <div class="code-block-wrapper">
<div class="code-header">üìù BASH</div>
<pre class="code-block"><code>Output: Could not start amazon-efs-mount-watchdog, unrecognized init system &quot;aws-efs-csi-dri&quot;</code></pre>
</div>

3. Rauneet noted repeated mount attempts failing due to timeouts:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù BASH</div>
<pre class="code-block"><code>b&#x27;mount.nfs4: Connection timed out&#x27;</code></pre>
</div>
   This suggested potential network or configuration issues.<br><br>

4. Configuration warnings were observed in the logs:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>Warning: config file does not have fips_mode_enabled item in section mount.. You should be able to find a new config file in the same folder as current config file /etc/amazon/efs/efs-utils.conf. Consider update the new config file to latest config file. Use the default value [fips_mode_enabled = False].Warning: config file does not have retry_nfs_mount_command item in section mount.. You should be able to find a new config file in the same folder as current config file /etc/amazon/efs/efs-utils.conf. Consider update the new config file to latest config file. Use the default value [retry_nfs_mount_command = True].</code></pre>
</div>
   These warnings indicated outdated configuration files that might need updating.<br><br>

5. Rauneet suggested checking EFS security groups to ensure NFS traffic (port 2049) was allowed:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>Check EFS Security Groups: Ensure the EFS file system fs-079fbe5bbe7a6b2cf has proper security group rules allowing NFS traffic (port 2049) from the EKS worker nodes.</code></pre>
</div>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. The customer was advised to verify and update the EFS security group rules to allow NFS traffic on port 2049 from the EKS worker nodes. This step was crucial to ensure network connectivity between the EFS and the nodes.<br><br>

2. It was recommended to restart the EFS CSI node pod to resolve any configuration issues that might have been causing the mounting failures:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>EFS CSI Driver Issue: The EFS CSI node pod may need to be restarted to resolve configuration issues.</code></pre>
</div>

3. The customer was also advised to update the EFS utilities configuration file to include missing parameters such as <code class="inline-code">fips_mode_enabled</code> and <code class="inline-code">retry_nfs_mount_command</code> to their default values, ensuring compatibility with the current system setup.<br>

4. Further investigation into the application logs was suggested to identify any additional issues causing the <code class="inline-code">CrashLoopBackOff</code> state, particularly focusing on the Java agents and memory settings:<br>
   <div class="code-block-wrapper">
<div class="code-header">üìù YAML</div>
<pre class="code-block"><code>-server -Xms1600m -Xmx5600m -XX:MaxMetaspaceSize=2000m -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/mnt/heapdumps -XX:OnOutOfMemoryError=/app/upload_heapdump.sh -XX:+ExitOnOutOfMemoryError -XX:+UseG1GC -XX:G1HeapRegionSize=15m -Xlog:gc*:file=/mnt/local/deploy/mis-healthlogs/logs/gc.log:uptimemillis,pid:filecount=10,filesize=10M -Dserver.servlet.session.cookie.secure=true -Dmanagement.endpoint.httptrace.enabled=false -Djdk.tls.client.protocols=TLSv1.2 -Dmanagement.endpoints.web.exposure.include=health,prometheus -Dio.netty.transport.noNative=true -Dserver.tomcat.accesslog.enabled=true -Dserver.tomcat.accesslog.request-attributes-enabled=true -Dserver.tomcat.accesslog.directory=/dev -Dserver.tomcat.accesslog.prefix=stdout -Dserver.tomcat.accesslog.buffered=false -Dserver.tomcat.accesslog.suffix= -Dserver.tomcat.accesslog.file-date-format= -Dserver.compression.enabled=true -Dserver.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json,image/svg+xml -Dserver.compression.min-response-size=1024</code></pre>
</div>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The likely root cause of the issue was a combination of network configuration and outdated EFS utility settings. The EFS file system was not properly configured to allow NFS traffic from the EKS worker nodes, as indicated by the repeated timeout errors during mount attempts. Additionally, the EFS utilities configuration was missing critical parameters, leading to compatibility issues with the current system setup. These factors, combined with potential issues in the EFS CSI driver, contributed to the failure in mounting the EFS and the subsequent <code class="inline-code">CrashLoopBackOff</code> state of the pods. Further investigation into the application logs and configuration updates were necessary to fully resolve the issue.<br>
                                </div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìé ClickUp Attachments & Screenshots</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin: 15px 0;">
                                    <div style="border: 2px solid #e5e7eb; border-radius: 8px; overflow: hidden; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <img src="https://t3443930.p.clickup-attachments.com/t3443930/35a60b68-7213-46c3-8baf-454a9789f858/Screenshot%202025-09-11%20at%205.52.55%E2%80%AFPM.png" alt="Screenshot 2025-09-11 at 5.52.55‚ÄØPM.png" style="width: 100%; height: 200px; object-fit: cover; cursor: pointer;" onclick="openImageViewer('https://t3443930.p.clickup-attachments.com/t3443930/35a60b68-7213-46c3-8baf-454a9789f858/Screenshot%202025-09-11%20at%205.52.55%E2%80%AFPM.png', 'Screenshot 2025-09-11 at 5.52.55‚ÄØPM.png')">
                                        <div style="padding: 12px; background: #f9fafb; border-top: 1px solid #e5e7eb;">
                                            <div style="font-weight: 600; color: #374151; margin-bottom: 4px;">Screenshot 2025-09-11 at 5.52.55‚ÄØPM.png</div>
                                            <a href="https://t3443930.p.clickup-attachments.com/t3443930/35a60b68-7213-46c3-8baf-454a9789f858/Screenshot%202025-09-11%20at%205.52.55%E2%80%AFPM.png" target="_blank" style="color: #7c3aed; text-decoration: none; font-size: 0.85rem;">View Full Size ‚Üí</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="MoveInSync_9">
                    <td><span class="expand-indicator">‚ñ∂</span> 9</td>
                    <td>got pull qps exceeded for pulling image from ecr in singapore region</td>
                    <td><a href="https://app.clickup.com/t/86d089jfu" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-08</td>
                    <td><span class="status status-default">pending (ack)</span></td>
                    <td>Rauneet Verma</td>
                </tr>
                <tr id="details_MoveInSync_9" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>MoveInSync</div>
                                <div><strong>Date:</strong><br>2025-09-08</div>
                                <div><strong>Status:</strong><br>pending (ack)</div>
                                <div><strong>Owner:</strong><br>Rauneet Verma</div>
                                <div><strong>ClickUp ID:</strong><br>86d089jfu</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, MoveInSync, encountered an issue where the image pull request per second (QPS) limit was exceeded while pulling images from Amazon Elastic Container Registry (ECR) in the Singapore region. This occurred during a rebalancing operation using CAST AI, which reschedules multiple pods simultaneously, leading to a high volume of concurrent image pulls. The expected behavior was for the pods to be rescheduled without hitting the QPS limit, but the actual result was a failure to pull images due to the exceeded limit, impacting the deployment process.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Umer Beigh noted that the rebalancer using CAST AI was causing multiple pods to be rescheduled at once, leading to simultaneous image pulls:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>we are running rebalancer using CAST AI which reschedules the pods</code></pre>
</div>
   This observation suggested that the high number of concurrent image pulls was likely causing the QPS limit to be exceeded.<br><br>

2. Anurag Jayaraman identified the need for a solution to modify or avoid the QPS limit to prevent recurrence of the issue:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>Action Item:
   to answer this</code></pre><br>
</div>
   This step was crucial to understanding the constraints and potential solutions for managing the image pull rate effectively.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. Anurag Jayaraman and Rauneet Verma were tasked with finding a solution to modify the QPS limit or implement a workaround to prevent the issue from recurring. However, no specific resolution steps were confirmed in the conversation, indicating that the resolution is pending further investigation or customer-side action.<br><br>

2. It was suggested that understanding and potentially modifying the QPS limit settings in ECR or implementing a staggered pod rescheduling strategy could mitigate the issue, but these actions were not confirmed as completed in the conversation.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The likely root cause of the issue was the simultaneous rescheduling of multiple pods by CAST AI, which led to a high volume of concurrent image pulls from ECR, exceeding the QPS limit. This was identified based on Umer Beigh's observation of the rebalancer's behavior. Further investigation is needed to confirm if adjusting the QPS limit or altering the rescheduling strategy can effectively resolve the issue. The conversation did not confirm a definitive resolution, indicating that further action is required to address the problem.<br><br>
                                </div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìé ClickUp Attachments & Screenshots</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin: 15px 0;">
                                    <div style="border: 2px solid #e5e7eb; border-radius: 8px; overflow: hidden; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <img src="https://t3443930.p.clickup-attachments.com/t3443930/583e5fd0-9688-4d33-a382-1a890c96cae9/image.png" alt="image.png" style="width: 100%; height: 200px; object-fit: cover; cursor: pointer;" onclick="openImageViewer('https://t3443930.p.clickup-attachments.com/t3443930/583e5fd0-9688-4d33-a382-1a890c96cae9/image.png', 'image.png')">
                                        <div style="padding: 12px; background: #f9fafb; border-top: 1px solid #e5e7eb;">
                                            <div style="font-weight: 600; color: #374151; margin-bottom: 4px;">image.png</div>
                                            <a href="https://t3443930.p.clickup-attachments.com/t3443930/583e5fd0-9688-4d33-a382-1a890c96cae9/image.png" target="_blank" style="color: #7c3aed; text-decoration: none; font-size: 0.85rem;">View Full Size ‚Üí</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="MoveInSync_10">
                    <td><span class="expand-indicator">‚ñ∂</span> 10</td>
                    <td> preview-ingress mis-prod-sg - Ingress rule for VMS service</td>
                    <td><a href="https://app.clickup.com/t/86d086aw1" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-08</td>
                    <td><span class="status status-default">needs customer response</span></td>
                    <td>Rauneet Verma</td>
                </tr>
                <tr id="details_MoveInSync_10" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>MoveInSync</div>
                                <div><strong>Date:</strong><br>2025-09-08</div>
                                <div><strong>Status:</strong><br>needs customer response</div>
                                <div><strong>Owner:</strong><br>Rauneet Verma</div>
                                <div><strong>ClickUp ID:</strong><br>86d086aw1</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, MoveInSync, was attempting to configure ingress rules for the VMS service using NGINX annotations to enable CORS and handle HTTP OPTIONS requests. The expected outcome was that the ingress rules would correctly apply the CORS settings, allowing specified headers and methods. However, after applying the configuration, the annotations did not populate correctly in the <code class="inline-code">nginx.conf</code> file, leading to issues with the service's functionality. This was in a Kubernetes environment, specifically affecting the <code class="inline-code">vehicle-management-service-springboot</code>. The impact was significant as it disrupted the service's ability to handle cross-origin requests properly.<br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Rauneet Verma suggested using specific annotations for the ingress rule to handle CORS, providing a JSON configuration example:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù JSON</div>
<pre class="code-block"><code>{
     &quot;vehicle-management-service-springboot&quot;: {<br>
       &quot;service_name&quot;: &quot;vehicle-management-service-springboot&quot;,<br>
       &quot;path&quot;: &quot;/vms&quot;,<br>
       &quot;port&quot;: &quot;8081&quot;,<br>
       &quot;port_name&quot;: &quot;http&quot;,<br>
       &quot;domain_prefix&quot;: &quot;&quot;,<br>
       &quot;annotations&quot;: {<br>
         &quot;nginx.ingress.kubernetes.io/configuration-snippet&quot;: &quot;if ($request_method = OPTIONS) {\n  more_set_headers \&quot;X-Wis-Token: *\&quot;;\n  more_set_headers \&quot;X-Mis-Token: *\&quot;;\n  add_header &#x27;Access-Control-Allow-Origin&#x27; &#x27;*&#x27; always;\n  add_header &#x27;Access-Control-Allow-Methods&#x27; &#x27;GET, POST, OPTIONS, PUT, DELETE&#x27; always;\n  add_header &#x27;Access-Control-Allow-Headers&#x27; &#x27;Authorization, Content-Type, X-Wis-Token, X-Mis-Token&#x27; always;\n  return 204;\n}&quot;<br>
       }<br>
     }<br>
   }</code></pre><br>
</div>

2. Azad Tomar applied the configuration but reported that it was not working. Rauneet Verma identified a syntax issue in the annotations, suggesting corrections:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>As discussed please check the configuration-snippet as there is a syntax issue in the annotation because of which is the annotation is not getting populated in the nginx.conf file. So please try these annotations</code></pre>
</div>

3. Rauneet Verma recommended changing the syntax from double quotes to single quotes for <code class="inline-code">more_set_headers</code> and using consistent formatting:<br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>Changed more_set_headers \&quot;X-Wis-Token: *\&quot; to more_set_headers &#x27;X-Wis-Token: *&#x27; (using single quotes)
   Used consistent format: more_set_headers &#x27;Header-Name: value&#x27;<br>
   return 204;</code></pre><br>
</div>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. Rauneet Verma advised correcting the syntax in the <code class="inline-code">nginx.ingress.kubernetes.io/configuration-snippet</code> by using single quotes for <code class="inline-code">more_set_headers</code> and ensuring consistent formatting:<br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>&quot;nginx.ingress.kubernetes.io/configuration-snippet&quot;: &quot;if ($request_method = OPTIONS) {\n  more_set_headers &#x27;X-Wis-Token: *&#x27;;\n  more_set_headers &#x27;X-Mis-Token: *&#x27;;\n  more_set_headers &#x27;Access-Control-Allow-Origin: *&#x27;;\n  more_set_headers &#x27;Access-Control-Allow-Methods: GET, POST, OPTIONS, PUT, DELETE&#x27;;\n  more_set_headers &#x27;Access-Control-Allow-Headers: Authorization, Content-Type, X-Wis-Token, X-Mis-Token&#x27;;\n  return 204;\n}&quot;</code></pre>
</div>

2. Azad Tomar tested the updated configuration, but it caused other URLs to stop working, leading to a rollback of the changes. The team decided to set up a similar environment in Dev for further testing and verification before applying changes to production.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The issue appears to be a syntax error in the NGINX ingress annotations, specifically within the <code class="inline-code">nginx.ingress.kubernetes.io/configuration-snippet</code>. The use of double quotes instead of single quotes for <code class="inline-code">more_set_headers</code> caused the annotations not to populate correctly in the <code class="inline-code">nginx.conf</code> file. This syntax issue prevented the proper handling of CORS requests, disrupting the service's functionality. Further investigation and testing in a development environment are needed to confirm the resolution and ensure no additional disruptions occur when reapplying the configuration.<br>
                                </div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìé ClickUp Attachments & Screenshots</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin: 15px 0;">
                                    <div style="border: 2px solid #e5e7eb; border-radius: 8px; overflow: hidden; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <img src="https://t3443930.p.clickup-attachments.com/t3443930/06b8e7b9-ccdb-415e-b044-7c1726823153/image%20(13).png" alt="image (13).png" style="width: 100%; height: 200px; object-fit: cover; cursor: pointer;" onclick="openImageViewer('https://t3443930.p.clickup-attachments.com/t3443930/06b8e7b9-ccdb-415e-b044-7c1726823153/image%20(13).png', 'image (13).png')">
                                        <div style="padding: 12px; background: #f9fafb; border-top: 1px solid #e5e7eb;">
                                            <div style="font-weight: 600; color: #374151; margin-bottom: 4px;">image (13).png</div>
                                            <a href="https://t3443930.p.clickup-attachments.com/t3443930/06b8e7b9-ccdb-415e-b044-7c1726823153/image%20(13).png" target="_blank" style="color: #7c3aed; text-decoration: none; font-size: 0.85rem;">View Full Size ‚Üí</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr></table></div>
    </div>
    
    <script>
        // Ensure all details are expanded when printing
        window.addEventListener('beforeprint', function() {
            // Expand all detail rows before printing
            const detailRows = document.querySelectorAll('[id^="details_"]');
            detailRows.forEach(row => {
                row.style.display = 'table-row';
            });
            
            // Hide expand indicators
            const indicators = document.querySelectorAll('.expand-indicator');
            indicators.forEach(indicator => {
                indicator.style.display = 'none';
            });
        });
        
        // Optional: Restore collapsed state after printing (commented out to keep expanded)
        // window.addEventListener('afterprint', function() {
        //     const detailRows = document.querySelectorAll('[id^="details_"]');
        //     detailRows.forEach(row => {
        //         row.style.display = 'none';
        //     });
        // });
        
        function toggleDetails(ticketId) {
            const detailsRow = document.getElementById('details_' + ticketId);
            const clickedRow = detailsRow.previousElementSibling;
            const indicator = clickedRow.querySelector('.expand-indicator');
            
            if (detailsRow.style.display === 'table-row') {
                detailsRow.style.display = 'none';
                indicator.innerHTML = '‚ñ∂';
                clickedRow.classList.remove('expanded');
            } else {
                // Close all other expanded rows
                document.querySelectorAll('[id^="details_"]').forEach(row => {
                    row.style.display = 'none';
                    if (row.previousElementSibling) {
                        row.previousElementSibling.classList.remove('expanded');
                        row.previousElementSibling.querySelector('.expand-indicator').innerHTML = '‚ñ∂';
                    }
                });
                
                detailsRow.style.display = 'table-row';
                indicator.innerHTML = '‚ñº';
                clickedRow.classList.add('expanded');
            }
        }
        
        let lastEnterTime = 0;

        function performSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            const sections = document.querySelectorAll('.customer-section');
            let totalVisible = 0;

            sections.forEach(section => {
                const customerName = section.querySelector('h2').textContent.toLowerCase();
                const rows = section.querySelectorAll('tr.expandable');
                let hasVisibleRows = false;

                rows.forEach(row => {
                    const cells = row.cells;
                    const title = cells[1] ? cells[1].textContent.toLowerCase() : '';
                    const clickupId = cells[2] ? cells[2].textContent.toLowerCase() : '';
                    const date = cells[3] ? cells[3].textContent.toLowerCase() : '';
                    const status = cells[4] ? cells[4].textContent.toLowerCase() : '';
                    const owner = cells[5] ? cells[5].textContent.toLowerCase() : '';

                    const shouldShow = searchTerm === '' ||
                                     title.includes(searchTerm) ||
                                     customerName.includes(searchTerm) ||
                                     clickupId.includes(searchTerm) ||
                                     date.includes(searchTerm) ||
                                     status.includes(searchTerm) ||
                                     owner.includes(searchTerm);

                    row.style.display = shouldShow ? '' : 'none';
                    if (shouldShow) {
                        hasVisibleRows = true;
                        totalVisible++;
                    }

                    // Hide details row if main row is hidden
                    const detailsRow = row.nextElementSibling;
                    if (detailsRow && detailsRow.id && detailsRow.id.startsWith('details_')) {
                        detailsRow.style.display = shouldShow ? '' : 'none';
                    }
                });

                section.style.display = hasVisibleRows ? '' : 'none';
            });

            updateSearchStatus(searchTerm ? `Found ${totalVisible} result(s)` : '');
        }

        function clearSearch() {
            document.getElementById('searchInput').value = '';
            performSearch();
            updateSearchStatus('Search cleared');
        }

        function updateSearchStatus(message) {
            let statusDiv = document.getElementById('searchStatus');
            if (!statusDiv) {
                statusDiv = document.createElement('div');
                statusDiv.id = 'searchStatus';
                statusDiv.style.cssText = 'text-align: center; padding: 10px; color: #7c3aed; font-size: 14px;';
                document.querySelector('.search-section').appendChild(statusDiv);
            }
            statusDiv.textContent = message;
            if (message) {
                setTimeout(() => { statusDiv.textContent = ''; }, 2000);
            }
        }
        
        // Enhanced keyboard support
        document.getElementById('searchInput').addEventListener('keyup', function(event) {
            const currentTime = Date.now();

            if (event.key === 'Enter') {
                if (this.value === '' && currentTime - lastEnterTime < 500) {
                    // Double-Enter on empty field clears any filters
                    clearSearch();
                    lastEnterTime = 0;
                } else {
                    performSearch();
                    lastEnterTime = currentTime;
                }
            } else if (event.key === 'Escape') {
                clearSearch();
            }
        });

        // Real-time search as you type
        document.getElementById('searchInput').addEventListener('input', function() {
            performSearch();
        });

        // Clear on double-click
        document.getElementById('searchInput').addEventListener('dblclick', function() {
            clearSearch();
        });

        // Cloud URLs will be injected here after upload
        window.reportCloudUrls = {};

        // Share functionality
        function shareReport() {
            console.log('Share button clicked!'); // Debug log

            const modal = document.getElementById('shareModal');
            const urlInput = document.getElementById('shareUrl');

            if (!modal) {
                console.error('Share modal not found!');
                alert('Error: Share modal not found. Please refresh the page.');
                return;
            }

            if (!urlInput) {
                console.error('Share URL input not found!');
                alert('Error: Share URL input not found. Please refresh the page.');
                return;
            }

            // Get the current page URL (or use the cloud URL if available)
            let shareUrl = window.location.href;

            // Check if we have cloud URLs stored in the page
            const cloudUrls = window.reportCloudUrls || {};
            console.log('Available cloud URLs:', cloudUrls); // Debug log

            // Prefer GitHub Pages, then Gist, then regular preview, then transfer.sh, then local
            if (cloudUrls.github_repo && cloudUrls.github_repo.github_pages_url) {
                shareUrl = cloudUrls.github_repo.github_pages_url;
                console.log('Using GitHub Pages URL (best option)');
            } else if (cloudUrls.github_gist && cloudUrls.github_gist.preview_url) {
                shareUrl = cloudUrls.github_gist.preview_url;
                console.log('Using GitHub gist preview URL');
            } else if (cloudUrls.github_repo && cloudUrls.github_repo.preview_url) {
                shareUrl = cloudUrls.github_repo.preview_url;
                console.log('Using GitHub repo preview URL (limited JavaScript)');
            } else if (cloudUrls.transfer_sh) {
                shareUrl = cloudUrls.transfer_sh;
                console.log('Using transfer.sh URL');
            } else {
                console.log('Using local file URL');
            }

            urlInput.value = shareUrl;

            // Also populate the backup URL (HTML Preview)
            const backupUrlInput = document.getElementById('shareUrlBackup');
            if (backupUrlInput) {
                let backupUrl = '';
                if (cloudUrls.github_repo && cloudUrls.github_repo.preview_url) {
                    backupUrl = cloudUrls.github_repo.preview_url;
                } else if (cloudUrls.github_gist && cloudUrls.github_gist.preview_url) {
                    backupUrl = cloudUrls.github_gist.preview_url;
                } else {
                    // Fallback: construct htmlpreview URL from current location
                    const currentUrl = window.location.href;
                    if (currentUrl.includes('github.io')) {
                        // Convert GitHub Pages URL to htmlpreview URL
                        const rawUrl = currentUrl.replace('abhishub-12.github.io/RCA-REPORTS/', 'raw.githubusercontent.com/AbhisHub-12/RCA-REPORTS/main/');
                        backupUrl = 'https://htmlpreview.github.io/?' + rawUrl;
                    } else {
                        backupUrl = 'HTML Preview not available for local files';
                    }
                }
                backupUrlInput.value = backupUrl;

                // Hide backup section if not available
                const backupSection = document.getElementById('backupSection');
                if (backupSection) {
                    if (backupUrl === 'HTML Preview not available for local files') {
                        backupSection.style.display = 'none';
                    } else {
                        backupSection.style.display = 'block';
                    }
                }
            }

            modal.style.display = 'block';
            console.log('Modal should now be visible'); // Debug log
        }

        function closeShareModal() {
            document.getElementById('shareModal').style.display = 'none';
            document.getElementById('copySuccess').style.display = 'none';
        }

        function copyShareLink() {
            const urlInput = document.getElementById('shareUrl');
            const copySuccess = document.getElementById('copySuccess');

            // Select and copy the text
            urlInput.select();
            urlInput.setSelectionRange(0, 99999); // For mobile devices

            try {
                document.execCommand('copy');
                copySuccess.style.display = 'block';

                // Hide success message after 3 seconds
                setTimeout(() => {
                    copySuccess.style.display = 'none';
                }, 3000);
            } catch (err) {
                // Fallback for modern browsers
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(urlInput.value).then(() => {
                        copySuccess.style.display = 'block';
                        setTimeout(() => {
                            copySuccess.style.display = 'none';
                        }, 3000);
                    });
                }
            }
        }

        function shareViaEmail() {
            const url = document.getElementById('shareUrl').value;
            const subject = encodeURIComponent('RCA Report - ' + document.title);
            const body = encodeURIComponent('Here is the RCA report:\n\n' + url);
            window.location.href = 'mailto:?subject=' + subject + '&body=' + body;
        }

        function shareViaSlack() {
            const url = document.getElementById('shareUrl').value;
            const text = encodeURIComponent('RCA Report: ' + url);
            // Open Slack's share URL (user needs to be logged in)
            window.open('https://slack.com/intl/en-in/share?url=' + encodeURIComponent(url), '_blank');
        }

        function shareViaTeams() {
            const url = document.getElementById('shareUrl').value;
            const text = encodeURIComponent('Check out this RCA Report');
            // Open Teams share dialog
            window.open('https://teams.microsoft.com/share?href=' + encodeURIComponent(url) + '&text=' + text, '_blank');
        }

        function shareViaWhatsApp() {
            const url = document.getElementById('shareUrl').value;
            const text = encodeURIComponent('RCA Report: ' + url);
            // Open WhatsApp with pre-filled message
            window.open('https://wa.me/?text=' + text, '_blank');
        }

        function copyBackupLink() {
            const backupUrlInput = document.getElementById('shareUrlBackup');
            // Select and copy the text
            backupUrlInput.select();
            backupUrlInput.setSelectionRange(0, 99999); // For mobile devices
            try {
                document.execCommand('copy');
                // Show temporary success indicator
                const button = document.getElementById('copyBackupLinkBtn');
                const originalText = button.innerHTML;
                button.innerHTML = '‚úÖ Copied!';
                button.style.background = '#10b981';
                // Reset after 2 seconds
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.style.background = '#059669';
                }, 2000);
            } catch (err) {
                console.error('Failed to copy backup link: ', err);
                alert('Failed to copy to clipboard. Please copy manually.');
            }
        }

        // Image Viewer Functions
        function openImageViewer(imageUrl, imageTitle) {
            const modal = document.getElementById('imageViewerModal');
            const image = document.getElementById('imageViewerImage');
            const title = document.getElementById('imageViewerTitle');

            image.src = imageUrl;
            image.alt = imageTitle;
            title.textContent = imageTitle;
            modal.style.display = 'block';

            // Prevent body scroll when modal is open
            document.body.style.overflow = 'hidden';
        }

        function closeImageViewer() {
            const modal = document.getElementById('imageViewerModal');
            modal.style.display = 'none';

            // Restore body scroll
            document.body.style.overflow = 'auto';
        }

        // Close image viewer with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeImageViewer();
            }
        });

        // Close modal when clicking outside
        document.getElementById('shareModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeShareModal();
            }
        });

        // Add keyboard shortcut for share (Ctrl+Shift+S)
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.shiftKey && e.key === 'S') {
                e.preventDefault();
                shareReport();
            }
        });

        // Enhanced debugging for GitHub Pages
        console.log('üîß SCRIPT LOADING: JavaScript file started');
        console.log('üåê ENVIRONMENT:', window.location.href);
        console.log('üìç USER AGENT:', navigator.userAgent);

        // Check for Content Security Policy issues
        if (typeof window.CSP !== 'undefined') {
            console.log('‚ö†Ô∏è CSP DETECTED:', window.CSP);
        }

        // Validate all functions are loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ DOM Content Loaded');
            console.log('‚úÖ ShareReport function:', typeof shareReport);
            console.log('‚úÖ ToggleDetails function:', typeof toggleDetails);
            console.log('‚úÖ Share modal element:', document.getElementById('shareModal') ? 'Found' : 'Not Found');
            console.log('‚úÖ Cloud URLs:', window.reportCloudUrls);

            // Test basic DOM manipulation
            try {
                const testElement = document.querySelector('.expandable');
                if (testElement) {
                    console.log('‚úÖ EXPANDABLE ELEMENTS FOUND:', document.querySelectorAll('.expandable').length);
                } else {
                    console.log('‚ùå NO EXPANDABLE ELEMENTS FOUND');
                }
            } catch (error) {
                console.error('‚ùå DOM QUERY ERROR:', error);
            }

            // Test event listener attachment
            try {
                const shareBtn = document.getElementById('shareReportBtn');
                if (shareBtn) {
                    console.log('‚úÖ SHARE BUTTON FOUND, ATTACHING LISTENERS');
                } else {
                    console.log('‚ùå SHARE BUTTON NOT FOUND');
                }
            } catch (error) {
                console.error('‚ùå EVENT LISTENER ERROR:', error);
            }

            // Add event listeners for ticket expansion (GitHub Pages compatible)
            document.querySelectorAll('.expandable').forEach(row => {
                row.addEventListener('click', function() {
                    const ticketId = this.getAttribute('data-ticket-id');
                    if (ticketId) {
                        toggleDetails(ticketId);
                    }
                });
            });

            // Add event listener for share button (GitHub Pages compatible)
            const shareBtn = document.getElementById('shareReportBtn');
            if (shareBtn) {
                shareBtn.addEventListener('click', function() {
                    console.log('Share button clicked via event listener!');
                    shareReport();
                });
            }

            // Add event listener for print button (GitHub Pages compatible)
            const printBtn = document.getElementById('printBtn');
            if (printBtn) {
                printBtn.addEventListener('click', function() {
                    window.print();
                });
            }

            // Add event listeners for modal buttons (GitHub Pages compatible)
            const closeModalBtn = document.getElementById('closeModalBtn');
            if (closeModalBtn) {
                closeModalBtn.addEventListener('click', closeShareModal);
            }

            const copyLinkBtn = document.getElementById('copyLinkBtn');
            if (copyLinkBtn) {
                copyLinkBtn.addEventListener('click', copyShareLink);
            }

            const copyBackupLinkBtn = document.getElementById('copyBackupLinkBtn');
            if (copyBackupLinkBtn) {
                copyBackupLinkBtn.addEventListener('click', copyBackupLink);
            }

            const shareEmailBtn = document.getElementById('shareEmailBtn');
            if (shareEmailBtn) {
                shareEmailBtn.addEventListener('click', shareViaEmail);
            }

            const shareSlackBtn = document.getElementById('shareSlackBtn');
            if (shareSlackBtn) {
                shareSlackBtn.addEventListener('click', shareViaSlack);
            }

            const shareTeamsBtn = document.getElementById('shareTeamsBtn');
            if (shareTeamsBtn) {
                shareTeamsBtn.addEventListener('click', shareViaTeams);
            }

            const shareWhatsAppBtn = document.getElementById('shareWhatsAppBtn');
            if (shareWhatsAppBtn) {
                shareWhatsAppBtn.addEventListener('click', shareViaWhatsApp);
            }

            // Add event listeners for search buttons (GitHub Pages compatible)
            const searchBtn = document.getElementById('searchBtn');
            if (searchBtn) {
                searchBtn.addEventListener('click', performSearch);
            }

            const clearBtn = document.getElementById('clearBtn');
            if (clearBtn) {
                clearBtn.addEventListener('click', clearSearch);
            }
        });
    </script>
</body>
</html>
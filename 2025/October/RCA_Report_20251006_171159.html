<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RCA Report - Capillary - Last 30 days</title>
    <style>
        body { font-family: -apple-system, Arial, sans-serif; margin: 0; background: #f8f9fa; }
        
        .header { 
            background: linear-gradient(135deg, #7c3aed 0%, #14b8a6 100%); 
            color: white; 
            padding: 25px 40px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 30px;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 25px;
        }
        
        .logo-text {
            font-size: 2rem;
            font-weight: bold;
            display: flex;
            align-items: baseline;
        }
        
        .logo-dot { color: #14b8a6; font-size: 2.5rem; margin: 0 2px; }
        .logo-cloud { color: #14b8a6; }
        
        .divider {
            width: 2px;
            height: 40px;
            background: rgba(255,255,255,0.3);
        }
        
        .report-title {
            font-size: 1.5rem;
            font-weight: 300;
        }
        
        .header-right { display: flex; align-items: center; gap: 40px; }
        .date-info { font-size: 0.95rem; opacity: 0.9; }
        .stats { display: flex; gap: 30px; }
        .stat { text-align: center; }
        .stat-number { font-size: 1.8rem; font-weight: bold; color: #14b8a6; }
        .stat-label { font-size: 0.75rem; opacity: 0.85; text-transform: uppercase; letter-spacing: 0.5px; margin-top: 2px; }
        
        .ai-badge {
            background: #10b981;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
            display: inline-block;
            margin-left: 10px;
        }
        
        .search-section {
            background: white;
            padding: 25px;
            margin: 30px auto;
            max-width: 1400px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .search-container { display: flex; gap: 15px; align-items: center; }
        .search-input { 
            flex: 1; 
            padding: 12px 20px; 
            border: 2px solid #e2e8f0; 
            border-radius: 8px; 
            font-size: 1rem; 
            outline: none; 
        }
        .search-input:focus { 
            border-color: #7c3aed; 
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1); 
        }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 0 20px 40px; }
        .customer-section { 
            background: white; 
            margin: 20px 0; 
            border-radius: 12px; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.08); 
            overflow: hidden; 
        }
        
        table { width: 100%; border-collapse: collapse; table-layout: auto; word-wrap: break-word; }
        th { 
            background: #fafafa; 
            padding: 12px 15px; 
            text-align: left; 
            font-size: 0.85rem; 
            color: #6b7280; 
            font-weight: 600; 
            text-transform: uppercase; 
            letter-spacing: 0.5px; 
        }
        td { 
            padding: 14px 15px; 
            border-bottom: 1px solid #f3f4f6; 
            color: #374151; 
        }
        
        tr.expandable { cursor: pointer; }
        tr.expandable:hover td { background: #f9fafb; }
        
        .expand-indicator { 
            display: inline-block; 
            margin-right: 8px; 
            transition: transform 0.3s; 
            color: #7c3aed; 
        }
        tr.expanded .expand-indicator { transform: rotate(90deg); }
        
        .status { 
            padding: 5px 10px; 
            border-radius: 6px; 
            font-size: 0.8rem; 
            font-weight: 500; 
        }
        .status-complete { background: #d1fae5; color: #065f46; }
        .status-open { background: #fef3c7; color: #92400e; }
        .status-progress { background: #dbeafe; color: #1e40af; }
        .status-default { background: #f3f4f6; color: #6b7280; }
        
        
        .ai-error-box {
            background: #fef2f2;
            border-left: 4px solid #ef4444;
            padding: 12px;
            margin-top: 8px;
            border-radius: 4px;
            font-size: 0.95rem;
        }
        
        .slack-indicator {
            display: inline-block;
            padding: 3px 8px;
            background: #4a1d96;
            color: white;
            border-radius: 4px;
            font-size: 0.75rem;
            margin-left: 8px;
        }
        
        /* Clean Code Block Styling */
        .code-block-wrapper {
            margin: 20px 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            background: #ffffff;
            max-width: 100%;
            width: 100%;
            box-sizing: border-box;
        }

        .code-header {
            background: linear-gradient(135deg, #374151 0%, #4b5563 100%);
            color: #f9fafb;
            padding: 12px 20px;
            font-size: 13px;
            font-weight: 600;
            letter-spacing: 0.5px;
            border-bottom: 1px solid #6b7280;
        }

        .code-block {
            margin: 0;
            padding: 20px;
            background: #1f2937;
            overflow: hidden;
            max-width: 100%;
            word-wrap: break-word;
            box-sizing: border-box;
        }

        .code-block code {
            color: #f3f4f6;
            font-family: 'SF Mono', 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.4;
            white-space: pre-wrap;
            word-break: break-all;
            overflow-wrap: break-word;
            display: block;
            max-width: 100%;
        }

        /* Clean Inline Code */
        .inline-code {
            background: #fef2f2;
            color: #dc2626;
            padding: 4px 8px;
            border-radius: 6px;
            font-family: 'SF Mono', 'Consolas', monospace;
            font-size: 0.9em;
            font-weight: 600;
            white-space: nowrap;
            border: 1px solid #fecaca;
        }

        /* Link Styles */
        .markdown-link {
            color: #2563eb;
            text-decoration: none;
            font-weight: 500;
            padding: 4px 8px;
            border-radius: 4px;
            background: #eff6ff;
            border: 1px solid #dbeafe;
            transition: all 0.2s;
            display: inline-block;
        }

        .markdown-link:hover {
            color: #1d4ed8;
            background: #dbeafe;
            border-color: #2563eb;
            transform: translateY(-1px);
        }

        .auto-link {
            color: #7c3aed;
            text-decoration: none;
            font-size: 0.95em;
            word-break: break-all;
            padding: 3px 6px;
            border-radius: 4px;
            background: #f3e8ff;
            border: 1px solid #d8b4fe;
        }

        .auto-link:hover {
            color: #5b21b6;
            background: #e9d5ff;
        }

        /* RCA Content Box */
        .rca-content-box {
            padding: 16px;
            background: #f0fdf4;
            border-left: 4px solid #10b981;
            border-radius: 8px;
            font-size: 0.95rem;
            line-height: 1.7;
            color: #1f2937;
            min-height: 60px;
        }

        .rca-content-box .code-block-wrapper {
            margin: 16px 0;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .rca-empty {
            color: #9ca3af;
            font-style: italic;
            padding: 20px;
            text-align: center;
            background: #f9fafb;
            border: 2px dashed #e5e7eb;
            border-radius: 6px;
        }

        /* Original pre styling for non-code blocks */
        pre {
            background: linear-gradient(135deg, #f8f9fa 0%, #f1f3f4 100%);
            border: 1px solid #d1d5db;
            border-left: 4px solid #7c3aed;
            border-radius: 8px;
            padding: 20px;
            margin: 16px 0;
            overflow-x: auto;
            font-size: 0.85rem;
            line-height: 1.5;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            position: relative;
        }
        
        /* Clean code blocks without content labels */
        
        code {
            font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', monospace;
            background: #e5e7eb;
            padding: 3px 6px;
            border-radius: 4px;
            font-size: 0.9em;
            color: #dc2626;
            font-weight: 500;
        }
        
        pre code {
            background: none;
            padding: 0;
            border-radius: 0;
            color: #1f2937;
            font-weight: 400;
            display: block;
            margin-top: 8px;
        }
        
        /* Enhanced syntax highlighting */
        .language-bash code,
        .language-shell code,
        .language-console code {
            color: #059669;
            font-weight: 500;
        }
        
        .language-log code,
        .language-text code {
            color: #374151;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .language-json code {
            color: #0891b2;
        }
        
        .language-yaml code,
        .language-yml code {
            color: #ea580c;
        }
        
        /* Download Button Styling */
        .download-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 10px;
        }

        .download-btn, .share-btn {
            background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px 16px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 120px;
        }

        .share-btn {
            background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(124, 58, 237, 0.4);
            background: linear-gradient(135deg, #6d28d9 0%, #9333ea 100%);
        }

        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
        }
        
        .download-icon {
            font-size: 1.1rem;
        }
        
        
        /* Comprehensive Print Styles for PDF Generation */
        @media print {
            /* Page setup for proper PDF sizing */
            @page {
                size: A4;
                margin: 10mm 15mm 10mm 15mm;
            }
            
            /* CRITICAL: Force all hidden content to show when printing */
            * {
                overflow: visible !important;
            }
            
            /* Reset body for print */
            body {
                margin: 0;
                padding: 0;
                font-size: 10pt !important;
                line-height: 1.3 !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                color-adjust: exact !important;
            }
            
            /* Scale down the entire content to fit */
            .header {
                padding: 15px 20px !important;
                page-break-after: avoid;
                break-after: avoid;
            }
            
            .header-content {
                max-width: 100% !important;
                font-size: 0.9em !important;
            }
            
            .logo-text {
                font-size: 1.3rem !important;
            }
            
            .report-title {
                font-size: 1.1rem !important;
            }
            
            .stat-number {
                font-size: 1.3rem !important;
            }
            
            /* Hide interactive elements */
            .download-container,
            .search-section {
                display: none !important;
            }
            
            /* Adjust container for print */
            .container {
                max-width: 100% !important;
                padding: 10px !important;
                margin: 0 !important;
            }
            
            /* Ensure tables fit on page */
            .customer-section {
                page-break-inside: avoid;
                break-inside: avoid;
                margin: 10px 0 !important;
            }
            
            table {
                width: 100% !important;
                font-size: 0.85em !important;
            }
            
            th, td {
                padding: 8px 10px !important;
                font-size: 0.85em !important;
            }
            
            /* Force all ticket details to be visible when printing */
            tr[id^="details_"] {
                display: table-row !important;
                visibility: visible !important;
                opacity: 1 !important;
                page-break-inside: avoid;
            }
            
            /* Override any inline styles */
            tr[style*="display: none"] {
                display: table-row !important;
            }
            
            /* Adjust expanded content for print */
            tr[id^="details_"] > td > div {
                padding: 15px 30px !important;
            }
            
            /* Make code blocks smaller but readable */
            pre {
                padding: 10px !important;
                margin: 8px 0 !important;
                font-size: 0.75em !important;
                page-break-inside: avoid;
                max-width: 100% !important;
                overflow: visible !important;
                white-space: pre-wrap !important;
                word-wrap: break-word !important;
            }
            
            pre code {
                font-size: 0.85em !important;
                white-space: pre-wrap !important;
                word-break: break-word !important;
            }
            
            /* Ensure all sections and content are visible */
            .expand-indicator {
                display: none !important;
            }
            
            /* Force all collapsed content to be visible */
            [style*="display: none"],
            [style*="display:none"] {
                display: block !important;
            }
            
            /* Ensure detail rows are visible */
            tr[id*="details"] {
                display: table-row !important;
            }
            
            /* Make sure all RCA content sections are visible */
            div[style*="background: #f9fafb"] {
                display: block !important;
                visibility: visible !important;
            }
            
            /* Adjust section headers */
            h2 {
                font-size: 1.2em !important;
                margin: 10px 0 !important;
                page-break-after: avoid;
            }
            
            h4 {
                font-size: 1em !important;
                margin: 8px 0 !important;
                page-break-after: avoid;
            }
            
            /* Ensure content boxes fit */
            div[style*="padding: 12px"] {
                padding: 8px !important;
                margin: 5px 0 !important;
            }
            
            /* Prevent page breaks in critical areas */
            .customer-section > div:first-child,
            .customer-section table {
                page-break-after: avoid;
            }
            
            /* Scale down any oversized content */
            * {
                max-width: 100% !important;
            }
            
            /* Ensure background colors print */
            .status,
            .ai-badge,
            pre {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
        }
        
        /* Special styling for error logs */
        pre:has(code:contains("error")),
        pre:has(code:contains("Error")),
        pre:has(code:contains("GRPC error")) {
            border-left-color: #dc2626;
            background: linear-gradient(135deg, #fef2f2 0%, #fef7f7 100%);
        }
        
        /* Removed error log labels */
        
        /* Special styling for mount/config logs */
        pre:has(code:contains("mount")),
        pre:has(code:contains("Mount")) {
            border-left-color: #f59e0b;
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
        }
        
        /* Removed mount log labels */
        
        /* Special styling for Java/JVM parameters */
        pre:has(code:contains("-server")),
        pre:has(code:contains("-Xms")) {
            border-left-color: #7c3aed;
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
        }
        
        /* Removed Java config labels */

        /* Image Viewer Modal Styles */
        .image-viewer-modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            cursor: pointer;
        }

        .image-viewer-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 95vw;
            max-height: 95vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .image-viewer-image {
            max-width: 100%;
            max-height: 85vh;
            object-fit: contain;
            border-radius: 8px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .image-viewer-title {
            color: white;
            background: rgba(0, 0, 0, 0.7);
            padding: 12px 20px;
            border-radius: 6px;
            margin-top: 15px;
            font-size: 1rem;
            font-weight: 500;
            text-align: center;
        }

        .image-viewer-close {
            position: absolute;
            top: 20px;
            right: 30px;
            color: white;
            font-size: 35px;
            font-weight: bold;
            cursor: pointer;
            z-index: 10001;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }

        .image-viewer-close:hover {
            background: rgba(0, 0, 0, 0.8);
        }

    </style>
</head>
<body>
    <!-- Download and Share Buttons -->
    <div class="download-container">
        <button class="download-btn" id="printBtn" title="Print / Save as PDF">
            <span class="download-icon">üñ®Ô∏è</span>
            <span>Print</span>
        </button>
        <button class="share-btn" id="shareReportBtn" title="Share Report Link">
            <span class="share-icon">üîó</span>
            <span>Share Link</span>
        </button>
    </div>

    <!-- Share Modal -->
    <div id="shareModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%;
                                background:rgba(0,0,0,0.5); z-index:10000;">
        <div style="background:white; border-radius:12px; padding:25px; max-width:500px;
                    width:90%; max-height:80vh; overflow:auto; position:fixed;
                    top:50%; left:50%; transform:translate(-50%, -50%);">
            <button id="closeModalBtn"
                    style="position:absolute; top:15px; right:15px; background:none;
                           border:none; font-size:24px; cursor:pointer; color:#6b7280;">√ó</button>
            <h3 style="margin:0 0 20px 0; color:#374151;">Share RCA Report</h3>

            <div style="margin-bottom:20px;">
                <label style="display:block; margin-bottom:8px; color:#6b7280; font-size:14px;">Report Link:</label>
                <div style="display:flex; gap:10px;">
                    <input id="shareUrl" type="text" readonly
                           style="flex:1; padding:10px; border:1px solid #e5e7eb; border-radius:6px;
                                  background:#f9fafb; font-family:monospace; font-size:13px;">
                    <button id="copyLinkBtn"
                            style="padding:10px 20px; background:#7c3aed; color:white;
                                   border:none; border-radius:6px; cursor:pointer;
                                   font-weight:500; white-space:nowrap;">
                        Copy Link
                    </button>
                </div>
                <div id="copySuccess" style="margin-top:10px; color:#10b981; font-size:14px; display:none;">
                    ‚úÖ Link copied to clipboard!
                </div>
            </div>

            <div style="margin-bottom:20px;">
                <label style="display:block; margin-bottom:12px; color:#6b7280; font-size:14px;">Quick Share:</label>
                <div style="display:grid; grid-template-columns:repeat(2, 1fr); gap:10px;">
                    <button id="shareEmailBtn"
                            style="padding:12px; background:#f3f4f6; border:1px solid #e5e7eb;
                                   border-radius:6px; cursor:pointer; display:flex; align-items:center;
                                   justify-content:center; gap:8px; transition:background 0.2s;">
                        <span>üìß</span> Email
                    </button>
                    <button id="shareSlackBtn"
                            style="padding:12px; background:#f3f4f6; border:1px solid #e5e7eb;
                                   border-radius:6px; cursor:pointer; display:flex; align-items:center;
                                   justify-content:center; gap:8px; transition:background 0.2s;">
                        <span>üí¨</span> Slack
                    </button>
                    <button id="shareTeamsBtn"
                            style="padding:12px; background:#f3f4f6; border:1px solid #e5e7eb;
                                   border-radius:6px; cursor:pointer; display:flex; align-items:center;
                                   justify-content:center; gap:8px; transition:background 0.2s;">
                        <span>üë•</span> Teams
                    </button>
                    <button id="shareWhatsAppBtn"
                            style="padding:12px; background:#f3f4f6; border:1px solid #e5e7eb;
                                   border-radius:6px; cursor:pointer; display:flex; align-items:center;
                                   justify-content:center; gap:8px; transition:background 0.2s;">
                        <span>üí¨</span> WhatsApp
                    </button>
                </div>
            </div>

            <div id="backupSection" style="margin-bottom:20px;">
                <label style="display:block; margin-bottom:8px; color:#6b7280; font-size:14px;">Alternative Link (HTML Preview):</label>
                <div style="display:flex; gap:10px;">
                    <input id="shareUrlBackup" type="text" readonly
                           style="flex:1; padding:10px; border:1px solid #e5e7eb; border-radius:6px;
                                  background:#f9fafb; font-family:monospace; font-size:13px;">
                    <button id="copyBackupLinkBtn"
                            style="padding:10px 20px; background:#059669; color:white;
                                   border:none; border-radius:6px; cursor:pointer;
                                   font-weight:500; white-space:nowrap;">
                        Copy Backup
                    </button>
                </div>
                <div style="margin-top:5px; color:#059669; font-size:12px;">
                    ‚úÖ This link works reliably for customer sharing
                </div>
            </div>

            <div style="padding:15px; background:#f0f9ff; border:1px solid #bae6fd;
                        border-radius:6px; margin-top:20px;">
                <p style="margin:0; color:#0369a1; font-size:14px; line-height:1.5;">
                    üí° <strong>Tip:</strong> This report can be opened directly in any browser.
                    The recipient will see the full interactive report with all features.
                </p>
            </div>
        </div>
    </div>

    <!-- Image Viewer Modal -->
    <div id="imageViewerModal" class="image-viewer-modal" onclick="closeImageViewer()">
        <div class="image-viewer-close" onclick="closeImageViewer()">&times;</div>
        <div class="image-viewer-content" onclick="event.stopPropagation()">
            <img id="imageViewerImage" class="image-viewer-image" src="" alt="">
            <div id="imageViewerTitle" class="image-viewer-title"></div>
        </div>
    </div>

    <div class="header">
        <div class="header-content">
            <div class="header-left">
                <div class="logo-section">
                    <div class="logo-text">
                        <span style="color: white;">Facets</span>
                        <span class="logo-dot">.</span>
                        <span class="logo-cloud">cloud</span>
                    </div>
                    <div class="divider"></div>
                    <div class="report-title">
                        RCA Report
                        <span class="ai-badge">‚ú® AI Enhanced</span>
                    </div>
                </div>
            </div>
            <div class="header-right">
                <div>
                    <div class="date-info">üìÖ Sep 06 - Oct 06, 2025</div>
                    <div class="date-info" style="margin-top: 5px;">Capillary - Last 30 days</div>
                </div>
                <div class="stats">
                    <div class="stat">
                        <div class="stat-number">14</div>
                        <div class="stat-label">Total Tickets</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number">1</div>
                        <div class="stat-label">Customers</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="search-section">
        <div class="search-container">
            <input type="text" class="search-input" id="searchInput"
                   placeholder="Search by ticket title, customer name, or status...">
            <button class="search-btn" id="searchBtn"
                    style="background: #7c3aed; color: white; padding: 12px 30px;
                           border: none; border-radius: 8px; cursor: pointer; margin: 0 5px;">
                üîç Search
            </button>
            <button class="clear-btn" id="clearBtn"
                    style="background: #dc2626; color: white; padding: 12px 30px;
                           border: none; border-radius: 8px; cursor: pointer; margin: 0 5px;">
                üîÑ Clear
            </button>
        </div>
    </div>
    
    <div class="container">
        <div class="customer-section">
            <div style="background: linear-gradient(135deg, #f8f9fa 0%, #f3f4f6 100%); 
                        padding: 20px 25px; display: flex; justify-content: space-between; align-items: center;">
                <h2>Capillary</h2>
                <span style="background: #14b8a6; color: white; padding: 6px 14px; 
                           border-radius: 20px; font-size: 0.85rem; font-weight: 500;">
                    14 tickets
                </span>
            </div>
            <table>
                <tr>
                    <th width="50">#</th>
                    <th>Title</th>
                    <th width="120">ClickUp</th>
                    <th width="100">Date</th>
                    <th width="120">Status</th>
                    <th width="150">Owner</th>
                </tr>
                <tr class="expandable" data-ticket-id="Capillary_1">
                    <td><span class="expand-indicator">‚ñ∂</span> 1</td>
                    <td>New Deployer  UI elb not working.</td>
                    <td><a href="https://app.clickup.com/t/86d0hampj" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-10-06</td>
                    <td><span class="status status-open">Open</span></td>
                    <td>Unassigned</td>
                </tr>
                <tr id="details_Capillary_1" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>Capillary</div>
                                <div><strong>Date:</strong><br>2025-10-06</div>
                                <div><strong>Status:</strong><br>Open</div>
                                <div><strong>Owner:</strong><br>Unassigned</div>
                                <div><strong>ClickUp ID:</strong><br>86d0hampj</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    <div class="rca-empty">No summary data available</div>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    <div class="rca-empty">No debug steps found</div>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    <div class="rca-empty">No resolution data available</div>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    <div class="rca-empty">Root cause not identified</div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="Capillary_2">
                    <td><span class="expand-indicator">‚ñ∂</span> 2</td>
                    <td>Role binding not working for custom role</td>
                    <td><a href="https://app.clickup.com/t/86d0gxvrv" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-10-04</td>
                    <td><span class="status status-default">needs customer response</span></td>
                    <td>Rauneet Verma</td>
                </tr>
                <tr id="details_Capillary_2" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>Capillary</div>
                                <div><strong>Date:</strong><br>2025-10-04</div>
                                <div><strong>Status:</strong><br>needs customer response</div>
                                <div><strong>Owner:</strong><br>Rauneet Verma</div>
                                <div><strong>ClickUp ID:</strong><br>86d0gxvrv</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer was attempting to bind a custom role to a user in their Kubernetes environment. The expected outcome was that the role binding would be created automatically after the role was set up. However, the binding was not created as anticipated, leading to issues with user permissions. The environment involved Kubernetes and the specific resource in question was <code class="inline-code">k8s_access_controls</code>. The impact was that users could not be assigned the necessary permissions, potentially affecting operations that rely on these roles.<br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. **Rauneet Verma** requested temporary access to the environment for testing purposes, which was granted by **Sreejith S**. This step was necessary to ensure that the team could perform the necessary checks and modifications in the environment.<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>access provided.</code></pre>
</div>

2. **Rauneet Verma** instructed **Sreejith S** to change the filename to <code class="inline-code">k8s_access_controls</code> and perform a release. This was intended to ensure that the correct configurations were applied.<br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>change the filename to k8s_access_controls and do a release.</code></pre>
</div>

3. **Sreejith S** confirmed that the role and cluster role were created, expecting the binding to be automatically established. However, this did not occur as expected, indicating a potential issue in the process.<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>I have already done that. I was expecting the binding to be created.</code></pre>
</div>

4. **Rauneet Verma** initially noted that the <code class="inline-code">k8s_access_controls</code> did not create the role binding and clusterrolebinding, but later retracted this statement, suggesting a misunderstanding or miscommunication.<br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>this k8s_access_controls does not create the role binding and clusterrolebinding.
   ignore my above message</code></pre><br>
</div>

5. **Samarthya Gupta** clarified that the creation of cluster role bindings (CRB) and role bindings (RB) occurs only when the kubeconfig file is downloaded, which was a crucial piece of information for understanding the process.<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>The crb and rbs are created only when the kubeconfig file is downloaded.</code></pre>
</div>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. **Rauneet Verma** provided detailed steps for binding the user to the role once the role or cluster role is created using the <code class="inline-code">k8s_access_controls</code> resource. This included creating a custom role, mapping it to a user group, and assigning users to that group.<br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>once the role/cluster role is created then to bound the user to the role 

   steps :<br>
   follow these steps to bind the user to the role:<br>
   and provide the name of the role or cluster role.<br>
   Note: Only one role or cluster role can be provided.</code></pre><br>
</div>

2. **Sreejith S** was advised to ensure that the kubeconfig file is downloaded to trigger the creation of the necessary bindings. This step was crucial to resolving the issue as it aligned with the clarification provided by **Samarthya Gupta**.<br><br>

3. The team confirmed that the process should work as expected once the kubeconfig file is downloaded, which would automatically create the necessary role bindings.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The issue appears to be related to a misunderstanding of the process required to create role bindings in Kubernetes. The bindings were not automatically created as expected because they are only triggered when the kubeconfig file is downloaded. This was clarified by **Samarthya Gupta**, indicating that the initial setup steps were incomplete without this action. Further investigation confirmed that the <code class="inline-code">k8s_access_controls</code> resource does not directly create bindings, and the process relies on the kubeconfig download to finalize the setup.<br>
                                </div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìé ClickUp Attachments & Screenshots</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin: 15px 0;">
                                    <div style="border: 2px solid #e5e7eb; border-radius: 8px; overflow: hidden; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <img src="https://t3443930.p.clickup-attachments.com/t3443930/6a9337c3-9597-4f10-a63d-2918a33adcc2/image.png" alt="image.png" style="width: 100%; height: 200px; object-fit: cover; cursor: pointer;" onclick="openImageViewer('https://t3443930.p.clickup-attachments.com/t3443930/6a9337c3-9597-4f10-a63d-2918a33adcc2/image.png', 'image.png')">
                                        <div style="padding: 12px; background: #f9fafb; border-top: 1px solid #e5e7eb;">
                                            <div style="font-weight: 600; color: #374151; margin-bottom: 4px;">image.png</div>
                                            <a href="https://t3443930.p.clickup-attachments.com/t3443930/6a9337c3-9597-4f10-a63d-2918a33adcc2/image.png" target="_blank" style="color: #7c3aed; text-decoration: none; font-size: 0.85rem;">View Full Size ‚Üí</a>
                                        </div>
                                    </div>
                                    <div style="border: 2px solid #e5e7eb; border-radius: 8px; overflow: hidden; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <img src="https://t3443930.p.clickup-attachments.com/t3443930/13fc6c33-a77b-4907-9d86-0ab6e56cf221/image.png" alt="image.png" style="width: 100%; height: 200px; object-fit: cover; cursor: pointer;" onclick="openImageViewer('https://t3443930.p.clickup-attachments.com/t3443930/13fc6c33-a77b-4907-9d86-0ab6e56cf221/image.png', 'image.png')">
                                        <div style="padding: 12px; background: #f9fafb; border-top: 1px solid #e5e7eb;">
                                            <div style="font-weight: 600; color: #374151; margin-bottom: 4px;">image.png</div>
                                            <a href="https://t3443930.p.clickup-attachments.com/t3443930/13fc6c33-a77b-4907-9d86-0ab6e56cf221/image.png" target="_blank" style="color: #7c3aed; text-decoration: none; font-size: 0.85rem;">View Full Size ‚Üí</a>
                                        </div>
                                    </div>
                                    <div style="border: 2px solid #e5e7eb; border-radius: 8px; overflow: hidden; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <img src="https://t3443930.p.clickup-attachments.com/t3443930/53f2aafd-077e-4a9b-b742-4a1a0e3dea05/Screenshot%202025-10-06%20at%2012.11.38%E2%80%AFPM.png" alt="Screenshot 2025-10-06 at 12.11.38‚ÄØPM.png" style="width: 100%; height: 200px; object-fit: cover; cursor: pointer;" onclick="openImageViewer('https://t3443930.p.clickup-attachments.com/t3443930/53f2aafd-077e-4a9b-b742-4a1a0e3dea05/Screenshot%202025-10-06%20at%2012.11.38%E2%80%AFPM.png', 'Screenshot 2025-10-06 at 12.11.38‚ÄØPM.png')">
                                        <div style="padding: 12px; background: #f9fafb; border-top: 1px solid #e5e7eb;">
                                            <div style="font-weight: 600; color: #374151; margin-bottom: 4px;">Screenshot 2025-10-06 at 12.11.38‚ÄØPM.png</div>
                                            <a href="https://t3443930.p.clickup-attachments.com/t3443930/53f2aafd-077e-4a9b-b742-4a1a0e3dea05/Screenshot%202025-10-06%20at%2012.11.38%E2%80%AFPM.png" target="_blank" style="color: #7c3aed; text-decoration: none; font-size: 0.85rem;">View Full Size ‚Üí</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="Capillary_3">
                    <td><span class="expand-indicator">‚ñ∂</span> 3</td>
                    <td>crm-nightly-new env release failing (Unidentified error occurred)</td>
                    <td><a href="https://app.clickup.com/t/86d0fnqnb" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-30</td>
                    <td><span class="status status-progress">in progress</span></td>
                    <td>Omendra Tomar</td>
                </tr>
                <tr id="details_Capillary_3" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>Capillary</div>
                                <div><strong>Date:</strong><br>2025-09-30</div>
                                <div><strong>Status:</strong><br>in progress</div>
                                <div><strong>Owner:</strong><br>Omendra Tomar</div>
                                <div><strong>ClickUp ID:</strong><br>86d0fnqnb</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, Capillary, was attempting to execute a release in their <code class="inline-code">crm-nightly-new</code> environment, which was expected to complete within 10-12 minutes as per usual. However, the release was failing with an unidentified error, and subsequent attempts were hindered by a state lock issue. Additionally, the release time increased significantly to 25-30 minutes. This issue was observed across all non-production clusters. The environment involved was using Infrastructure as Code (IAC) with recent changes in the stage/3.30.20 version, which appeared to be causing the delays and failures.<br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. **Nihar Jain** observed that releases were failing with an unidentified error and subsequent attempts were blocked by a state lock. This was noted on [Date/Time not provided].<br><br>

2. **Omendra Tomar** began investigating the issue and identified that the problem was related to a newly introduced feature in the recent IAC releases. This was communicated on [Date/Time not provided].<br><br>

3. **Nihar Jain** noted that the release times had increased from the usual 10-12 minutes to over 30 minutes, indicating a performance degradation. This was observed on [Date/Time not provided].<br><br>

4. **Omendra Tomar** identified the newly introduced feature actions as the cause of the issue and suggested reverting these changes to restore stability. This was communicated on [Date/Time not provided].<br><br>

5. **Nihar Jain** reverted the IAC to stage/3.30.19, which restored the release times to normal, confirming the issue was related to the changes in stage/3.30.20. This was done on [Date/Time not provided].<br><br>

<div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>i have observed one more thing, that from</code></pre>
</div>

<div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>now releases are not failing, but time to complete release in all non prod cluster is very high</code></pre>
</div>

<div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>I reverted IAC to stage/3.30.19, and release is taking as usual time, currently i am pinning all my non-prod cluster to IAC - stage/3.30.19.</code></pre>
</div>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. **Omendra Tomar** recommended reverting the newly introduced feature actions in the IAC stage/3.30.20 to restore system stability. This was communicated on [Date/Time not provided].<br><br>

2. **Nihar Jain** executed the rollback to IAC stage/3.30.19, which resolved the issue of increased release times and restored the system to its expected performance levels. This action was confirmed on [Date/Time not provided].<br><br>

3. **Nihar Jain** pinned all non-production clusters to IAC stage/3.30.19 to prevent further issues until a stable release is confirmed. This was done on [Date/Time not provided].<br><br>

4. **Prashant Dhanke** communicated to the team to avoid pushing the problematic changes to the production tag and to notify once the issue is resolved in the stage tag. This was communicated on [Date/Time not provided].<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The likely root cause of the issue was the introduction of a new feature in the IAC stage/3.30.20 release, which caused unexpected delays and failures in the release process. This was identified by Omendra Tomar and confirmed by reverting to the previous stable version, stage/3.30.19, which restored normal operation. The feature likely introduced additional processing or dependencies that were not optimized, leading to increased execution times and state lock issues. Further investigation into the specific changes in the feature is needed to confirm the exact technical cause.<br><br>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="Capillary_4">
                    <td><span class="expand-indicator">‚ñ∂</span> 4</td>
                    <td>ecr-token-refresher-deployer job is failing leading to issues in multiple pod image pull in SGCRM</td>
                    <td><a href="https://app.clickup.com/t/86d0f8aq1" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-29</td>
                    <td><span class="status status-default">customer side fix</span></td>
                    <td>Rauneet Verma</td>
                </tr>
                <tr id="details_Capillary_4" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>Capillary</div>
                                <div><strong>Date:</strong><br>2025-09-29</div>
                                <div><strong>Status:</strong><br>customer side fix</div>
                                <div><strong>Owner:</strong><br>Rauneet Verma</div>
                                <div><strong>ClickUp ID:</strong><br>86d0f8aq1</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, Capillary, was experiencing issues with the <code class="inline-code">ecr-token-refresher-deployer</code> job, which was failing and causing problems with multiple pod image pulls in the SGCRM environment. The expected behavior was for the pods to pull images successfully and operate normally. However, the <code class="inline-code">coredns</code> pods were in a pending state, preventing the <code class="inline-code">ecr-token-refresher-deployer</code> pods from creating the necessary secrets, leading to the failure of image pulls. This issue was critical as it affected the deployment and operation of services within the SGCRM environment.<br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Rauneet Verma observed that the <code class="inline-code">coredns</code> pods were in a pending state, which was a critical issue as it blocked the scheduling of other pods. This was identified as a potential cause for the failure of the <code class="inline-code">ecr-token-refresher-deployer</code> pods to create necessary secrets.<br>

2. To address the pending state of the <code class="inline-code">coredns</code> pods, Rauneet Verma deleted the <code class="inline-code">coredns</code> pods. This action was intended to force the rescheduling of these pods, which would potentially resolve the blockage and allow other pods to function correctly.<br>

3. After deleting the <code class="inline-code">coredns</code> pods, Rauneet confirmed that they were successfully rescheduled. This action allowed the <code class="inline-code">ecr-token-refresher-deployer</code> pods to create the required secrets, which was a critical step in resolving the image pull issues.<br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. Rauneet Verma deleted the <code class="inline-code">coredns</code> pods to resolve their pending state. This action was necessary to unblock the scheduling of the <code class="inline-code">ecr-token-refresher-deployer</code> pods.<br>

2. After the deletion, the <code class="inline-code">coredns</code> pods were successfully rescheduled, which allowed the <code class="inline-code">ecr-token-refresher-deployer</code> pods to create the necessary secrets. This step was crucial in resolving the image pull issues.<br>

3. Once the secrets were created, the pods were able to pull images successfully, and the services were restored to normal operation. This confirmed that the issue was resolved on the customer side, as indicated by the ticket status.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The likely root cause of the issue was the <code class="inline-code">coredns</code> pods being in a pending state, which prevented the <code class="inline-code">ecr-token-refresher-deployer</code> pods from creating necessary secrets. This blockage led to failures in pulling images for multiple pods in the SGCRM environment. The deletion and rescheduling of the <code class="inline-code">coredns</code> pods resolved the pending state, allowing the <code class="inline-code">ecr-token-refresher-deployer</code> pods to function correctly and create the required secrets. Further investigation into why the <code class="inline-code">coredns</code> pods were initially in a pending state could provide additional insights into preventing similar issues in the future.<br>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="Capillary_5">
                    <td><span class="expand-indicator">‚ñ∂</span> 5</td>
                    <td>When we configure new Alerts, the alerts are not created in prometheus</td>
                    <td><a href="https://app.clickup.com/t/86d0dx4qy" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-24</td>
                    <td><span class="status status-default">needs customer response</span></td>
                    <td>Rauneet Verma</td>
                </tr>
                <tr id="details_Capillary_5" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>Capillary</div>
                                <div><strong>Date:</strong><br>2025-09-24</div>
                                <div><strong>Status:</strong><br>needs customer response</div>
                                <div><strong>Owner:</strong><br>Rauneet Verma</div>
                                <div><strong>ClickUp ID:</strong><br>86d0dx4qy</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, Capillary, was attempting to configure new alerts in Prometheus, expecting them to appear in the Prometheus UI. However, the alerts were not being created due to a syntax error in one of the Prometheus rules. Specifically, the rule <code class="inline-code">EventNotificationKafkaEventsInQueue</code> contained an invalid PromQL expression, which caused the Prometheus Operator to reject all rules, preventing any new rules from being displayed. This issue was identified in the default namespace of their Kubernetes environment, impacting their ability to monitor specific events effectively.<br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Rauneet Verma requested the output of <code class="inline-code">kubectl get prometheusrules</code> to verify the current rules, but encountered a permission issue:<br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>Error from server (Forbidden): prometheusrules.monitoring.coreos.com is forbidden: User &quot;system:serviceaccount:default:rauneet.verma-facets.cloud&quot; cannot list resource &quot;prometheusrules&quot; in API group &quot;monitoring.coreos.com&quot; in the namespace &quot;default&quot;</code></pre>
</div>
   This indicated a lack of necessary permissions to access the Prometheus rules.<br><br>

2. Kishan Kumar confirmed that the alert <code class="inline-code">mongo-auditlog-alert-alert-group</code> was visible, suggesting some alerts were configured but not all were appearing as expected.<br>

3. Rauneet Verma executed a command to check the logs of the Prometheus Operator pod for errors related to rules:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù BASH</div>
<pre class="code-block"><code>kubectl logs prometheus-operator-operator-57f844c6c5-sm2h8 -n default --tail=100 | grep -E &#x27;rule|error|warn|fail&#x27; -i</code></pre>
</div>
   The logs revealed:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>level=info ts=2025-09-25T06:06:50.780170556Z caller=rules.go:41 component=prometheusoperator msg=&quot;Invalid rule&quot; err=&quot;8:11: group \&quot;pod.rules\&quot;, rule 1, \&quot;EventNotificationKafkaEventsInQueue\&quot;: could not parse expression: 1:97: parse error: unexpected character inside braces: &#x27;)&#x27;&quot;
   level=error ts=2025-09-25T06:06:51.099281788Z caller=klog.go:116 component=k8s_client_runtime func=ErrorDepth msg=&quot;sync \&quot;default/prometheus-operator-prometheus\&quot; failed: Invalid rule&quot;</code></pre><br>
</div>
   This confirmed a syntax error in the PromQL expression of the rule <code class="inline-code">EventNotificationKafkaEventsInQueue</code>.<br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. Rauneet Verma identified the syntax error in the PromQL expression of the rule <code class="inline-code">EventNotificationKafkaEventsInQueue</code>, which was causing the Prometheus Operator to reject all rules. The error was due to an unexpected character <code class="inline-code">)</code> inside braces at position 97.<br>

2. Kishan Kumar was advised to correct the syntax error in the PromQL expression of the rule <code class="inline-code">EventNotificationKafkaEventsInQueue</code> to resolve the issue. This correction would allow the Prometheus Operator to successfully sync the rules and display them in the Prometheus UI.<br>

3. The team awaited confirmation from Kishan Kumar after the syntax correction to verify if the alerts were successfully appearing in the Prometheus UI. As of the last update, the resolution was pending confirmation from the customer.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The likely root cause of the issue was a syntax error in the PromQL expression of the rule <code class="inline-code">EventNotificationKafkaEventsInQueue</code>. This error, specifically an unexpected <code class="inline-code">)</code> character inside braces, caused the Prometheus Operator to reject the entire set of rules. Consequently, no new alerts were being created or displayed in the Prometheus UI. This was identified through log analysis of the Prometheus Operator pod, which highlighted the invalid rule and the resulting failure to sync the PrometheusRule configuration. Further investigation and correction of the syntax error were necessary to resolve the issue.<br>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="Capillary_6">
                    <td><span class="expand-indicator">‚ñ∂</span> 6</td>
                    <td>Annotation change not reflecting in security group - deployer-lb-new</td>
                    <td><a href="https://app.clickup.com/t/86d0d02v0" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-22</td>
                    <td><span class="status status-default">customer side fix</span></td>
                    <td>Omendra Tomar</td>
                </tr>
                <tr id="details_Capillary_6" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>Capillary</div>
                                <div><strong>Date:</strong><br>2025-09-22</div>
                                <div><strong>Status:</strong><br>customer side fix</div>
                                <div><strong>Owner:</strong><br>Omendra Tomar</div>
                                <div><strong>ClickUp ID:</strong><br>86d0d02v0</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, Capillary, was attempting to update the annotations for their <code class="inline-code">deployer-lb-new</code> service to reflect changes in the AWS security group. The expected outcome was for the new IP ranges specified in the annotations to be applied to the security group. However, the changes were not taking effect due to the AWS security group reaching its maximum rule limit. This resulted in a <code class="inline-code">RulesPerSecurityGroupLimitExceeded</code> error, preventing the load balancer from updating with the new rules. The issue was identified in the <code class="inline-code">deployer-infra</code> environment, impacting the service's ability to manage traffic effectively.<br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Omendra Tomar requested access to the <code class="inline-code">deployer-infra</code> environment to investigate the issue further. Sreejith S granted the necessary permissions.<br>

2. Omendra Tomar examined the current configuration of the service and identified that the <code class="inline-code">load-balancer-source-ranges</code> annotation was set with multiple IP addresses:<br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>service.beta.kubernetes.io/load-balancer-source-ranges: &gt;-
   0.0.0.0/0,3.225.18.198/32,3.229.249.100/32,35.172.238.236/32,52.24.221.0/32,<br>
   44.229.119.0/32,34.212.14.28/32,50.112.110.255/32,54.218.189.181/32,<br>
   35.162.29.228/32,54.247.60.162/32,52.214.98.25/32,54.235.251.85/32,<br>
   3.227.110.70/32,13.214.150.33/32,52.77.72.215/32,3.0.242.134/32,3.1.68.245/32,<br>
   15.206.252.159/32,15.206.252.149/32,18.224.36.121/32,18.189.151.155/32,<br>
   54.144.169.188/32,52.21.28.28/32,3.130.198.24/32,18.188.84.75/32,<br>
   18.211.138.37/32,63.33.234.65/32,54.77.13.74/32,34.253.37.18/32,<br>
   79.125.32.40/32,18.204.109.171/32,44.216.85.93/32,13.56.244.16/32,<br>
   52.21.28.30/32,192.30.252.0/22,143.55.64.0/20,185.199.108.0/22,140.82.112.0/20</code></pre><br>
</div>

3. Omendra Tomar identified the error message in the Kubernetes service-controller events:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù BASH</div>
<pre class="code-block"><code>kubectl describe svc deployer-lb-new -n default</code></pre>
</div>
   The error message indicated:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>Warning  SyncLoadBalancerFailed  38m (x3825 over 13d)    service-controller  (combined from similar events): Error syncing load balancer: failed to ensure load balancer: error authorizing security group ingress: &quot;RulesPerSecurityGroupLimitExceeded: The maximum number of rules per security group has been reached.\n\tstatus code: 400, request id: 35b32001-3601-40cb-a402-8dcf33067cfd&quot;</code></pre>
</div>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. Omendra Tomar suggested removing unused IPs from the service‚Äôs annotation to free up space for new rules. This would help in managing the number of rules within the AWS security group limit.<br><br>

2. Rauneet Verma confirmed that the issue was customer was provided guidance for updating the CIDR ranges in the service under <code class="inline-code">spec.loadBalancerSourceRanges</code>:<br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>This is fixed by passing the cidr ranges in the service under spec.loadBalancerSourceRanges:
   - &quot;143.231.0.0/16&quot;</code></pre><br>
</div>

3. It was recommended that if consolidating IP ranges was insufficient, the customer could request a quota increase for the "RulesPerSecurityGroup" limit through the AWS Support Center.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The root cause of the issue was the AWS security group reaching its maximum rule limit, which prevented the application of new IP ranges specified in the <code class="inline-code">deployer-lb-new</code> service annotations. This was due to the service having over 40 individual IP addresses or CIDR blocks, each requiring a separate rule in the security group. The AWS Load Balancer Controller was unable to update the security group, resulting in a <code class="inline-code">RulesPerSecurityGroupLimitExceeded</code> error. The issue was identified through the Kubernetes service-controller events, which logged repeated failures to sync the load balancer due to this limitation.<br>
                                </div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìé ClickUp Attachments & Screenshots</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin: 15px 0;">
                                    <div style="border: 2px solid #e5e7eb; border-radius: 8px; overflow: hidden; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <img src="https://t3443930.p.clickup-attachments.com/t3443930/ae085b5b-ef02-43cd-b7b0-27d34463624b/image.png" alt="image.png" style="width: 100%; height: 200px; object-fit: cover; cursor: pointer;" onclick="openImageViewer('https://t3443930.p.clickup-attachments.com/t3443930/ae085b5b-ef02-43cd-b7b0-27d34463624b/image.png', 'image.png')">
                                        <div style="padding: 12px; background: #f9fafb; border-top: 1px solid #e5e7eb;">
                                            <div style="font-weight: 600; color: #374151; margin-bottom: 4px;">image.png</div>
                                            <a href="https://t3443930.p.clickup-attachments.com/t3443930/ae085b5b-ef02-43cd-b7b0-27d34463624b/image.png" target="_blank" style="color: #7c3aed; text-decoration: none; font-size: 0.85rem;">View Full Size ‚Üí</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="Capillary_7">
                    <td><span class="expand-indicator">‚ñ∂</span> 7</td>
                    <td>S3 Leagcy to Alpha Issue </td>
                    <td><a href="https://app.clickup.com/t/86d0cdqzn" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-19</td>
                    <td><span class="status status-progress">in progress</span></td>
                    <td>Abhisht Bagewadi</td>
                </tr>
                <tr id="details_Capillary_7" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>Capillary</div>
                                <div><strong>Date:</strong><br>2025-09-19</div>
                                <div><strong>Status:</strong><br>in progress</div>
                                <div><strong>Owner:</strong><br>Abhisht Bagewadi</div>
                                <div><strong>ClickUp ID:</strong><br>86d0cdqzn</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, Capillary, was attempting to address an issue related to the transition from S3 Legacy to Alpha. The expected outcome was a seamless transition without any disruptions. However, the process encountered unspecified issues, prompting the customer to seek assistance. The environment specifics were not initially clear, leading to a request for clarification and access to the relevant environment for further investigation. The issue was marked as high priority, indicating a significant impact on the customer's operations.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Abhisht Bagewadi requested clarification on the specific environment involved in the issue to ensure accurate investigation. This was necessary to identify the correct resources and configurations that might be causing the problem.<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>Could you let me know which environment you are referring to?</code></pre>
</div>

2. Prashant Dhanke suggested that Abhisht Bagewadi consult with Rohit Raveendran for additional insights or access, indicating a collaborative approach to troubleshooting the issue. This step was aimed at gathering more context or permissions needed to proceed with the investigation.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. The team was advised to clarify the environment details with the customer to ensure they were investigating the correct setup. This step was crucial to avoid misdiagnosis and to focus efforts on the right configuration.<br><br>

2. It was recommended that Abhisht Bagewadi coordinate with Rohit Raveendran to gain necessary access or insights, which would facilitate a more thorough investigation of the issue. This step was aimed at leveraging team resources for a more effective resolution process.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The root cause of the issue remains undetermined as the investigation is still ongoing. The initial steps involved clarifying the environment details to ensure the correct resources were being examined. The issue appears to be related to the transition process from S3 Legacy to Alpha, but further investigation is needed to confirm the exact technical cause. The team is working collaboratively to gather the necessary information and access to proceed with a detailed analysis.<br><br>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="Capillary_8">
                    <td><span class="expand-indicator">‚ñ∂</span> 8</td>
                    <td>Container Storage Usage Metric Not Available</td>
                    <td><a href="https://app.clickup.com/t/86d0cahpn" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-19</td>
                    <td><span class="status status-default">needs customer response</span></td>
                    <td>Abhisht Bagewadi</td>
                </tr>
                <tr id="details_Capillary_8" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>Capillary</div>
                                <div><strong>Date:</strong><br>2025-09-19</div>
                                <div><strong>Status:</strong><br>needs customer response</div>
                                <div><strong>Owner:</strong><br>Abhisht Bagewadi</div>
                                <div><strong>ClickUp ID:</strong><br>86d0cahpn</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, Capillary, was experiencing an issue where the <code class="inline-code">container_fs_usage_bytes</code> metric was not being collected in Prometheus. This metric is crucial for monitoring container storage usage, and its absence was due to default filtering rules applied by the Helm chart used for Prometheus deployment. The expected behavior was for all container filesystem metrics to be collected, but the default configuration was preventing this. The issue was identified as a common problem within the community, as noted in a related GitHub issue. The environment affected was not specified in the conversation, but the problem was acknowledged as impacting metrics collection across the board.<br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Abhisht Bagewadi identified the issue with the <code class="inline-code">container_fs_usage_bytes</code> metric not being collected due to default filtering rules in the Helm chart. This was confirmed by observing the absence of this metric in Prometheus, which was expected to be present for monitoring purposes.<br>

2. The team referred to a community-reported issue on GitHub, indicating that this was a known problem affecting metrics collection. This provided additional context and validation that the issue was not isolated to the customer's environment.<br><br>

3. Abhisht suggested updating the Prometheus resource configuration to address the filtering issue. The proposed configuration changes were shared to remove the default cAdvisor metric filtering, which was preventing the collection of the desired metrics.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. Abhisht Bagewadi recommended updating the Prometheus resource with an advanced configuration to remove the default cAdvisor metric filtering. The configuration provided was:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù JSON</div>
<pre class="code-block"><code>{
     &quot;advanced&quot;: {<br>
       &quot;kube_prometheus_stack&quot;: {<br>
         &quot;values&quot;: {<br>
           &quot;kubelet&quot;: {<br>
             &quot;serviceMonitor&quot;: {<br>
               &quot;cAdvisorMetricRelabelings&quot;: []<br>
             }<br>
           }<br>
         }<br>
       }<br>
     }<br>
   }</code></pre><br>
</div>
   This change was intended to enable the collection of all container filesystem metrics, including <code class="inline-code">container_fs_usage_bytes</code>.<br>

2. The effects of this change were outlined, including increased metric volume, higher Prometheus memory consumption, and faster growth of the time-series database due to additional metrics. These considerations were important for resource planning and ensuring the system could handle the increased load.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The root cause of the issue was the default filtering rules applied by the Helm chart used for deploying Prometheus, which excluded the <code class="inline-code">container_fs_usage_bytes</code> metric from being collected. This filtering was part of the default configuration for cAdvisor metrics, which are crucial for monitoring container storage usage. The problem was identified through community reports and confirmed by the absence of the metric in the customer's Prometheus setup. The proposed solution involved updating the Prometheus configuration to remove these filtering rules, thereby restoring full visibility into container storage metrics.<br>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="Capillary_9">
                    <td><span class="expand-indicator">‚ñ∂</span> 9</td>
                    <td>Too many Grant Previlige calls from Crossplane to Mysql Users.</td>
                    <td><a href="https://app.clickup.com/t/86d0bwzj4" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-18</td>
                    <td><span class="status status-default">needs customer response</span></td>
                    <td>Debarshi Mullick</td>
                </tr>
                <tr id="details_Capillary_9" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>Capillary</div>
                                <div><strong>Date:</strong><br>2025-09-18</div>
                                <div><strong>Status:</strong><br>needs customer response</div>
                                <div><strong>Owner:</strong><br>Debarshi Mullick</div>
                                <div><strong>ClickUp ID:</strong><br>86d0bwzj4</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, Capillary, reported an issue with excessive GRANT privilege calls from Crossplane to MySQL users. This behavior was unexpected as it resulted in a high volume of audit log entries, which was not anticipated. The environment involved Crossplane's integration with MySQL, where Crossplane's declarative reconciliation pattern was causing repeated GRANT operations every 10 minutes. This was due to Crossplane's design to ensure the actual state matches the desired state, leading to repeated application of permissions even if unchanged. The impact was primarily on audit log noise and potential performance concerns.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Rohit Raveendran explained the behavior of Crossplane, noting that it follows a declarative reconciliation pattern. This pattern ensures that the actual state of the system matches the desired state by checking existing permissions, comparing them with the desired state, and reapplying GRANTs every 10 minutes. This process is logged to create an audit trail.<br><br>

2. The team identified that this behavior is intentional for drift detection, self-healing, and idempotency. These features are designed to catch manual permission changes, automatically fix discrepancies, and safely run operations repeatedly without adverse effects.<br><br>

3. Rohit suggested a solution involving a two-tier user management approach to mitigate the issue. This approach involves creating a 'User-Provisioner' MySQL user with root credentials to manage other users, thereby reducing the audit log entries associated with the root user.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. Rohit Raveendran proposed implementing a two-tier user management system. This involves creating a 'User-Provisioner' MySQL user using root credentials from the RDS master database. This user would have ADMIN privileges on <code class="inline-code">mysql.*</code> to create users and grant permissions.<br>

2. The 'User-Provisioner' user would be reconciled every 10 minutes, limiting the root's audit log entries to just one user's management. This approach ensures that all subsequent users are created using the 'User-Provisioner' credentials, not the root, thereby reducing audit log noise.<br><br>

3. Application users would be created using the 'User-Provisioner' credentials, ensuring that all GRANT operations in audit logs appear as coming from the 'provisioner' user, not the root. This setup allows for creating read-only, read-write, or schema-management users as needed, effectively addressing the audit log noise issue.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The issue appears to be caused by Crossplane's design, which follows a declarative reconciliation pattern. This pattern ensures that the actual state of the system matches the desired state by reapplying GRANT operations every 10 minutes, even if there are no changes. This behavior, while intentional for ensuring consistency and self-healing, led to excessive audit log entries. The proposed solution of using a 'User-Provisioner' user aims to reduce the noise by limiting the root user's direct involvement in user management, thereby minimizing the audit log entries associated with root operations.<br><br>
                                </div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìé ClickUp Attachments & Screenshots</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin: 15px 0;">
                                    <div style="border: 2px solid #e5e7eb; border-radius: 8px; overflow: hidden; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <img src="https://t3443930.p.clickup-attachments.com/t3443930/66a97d66-1a1d-41d9-8033-2209a6a266a9/GrantAccess.png" alt="GrantAccess.png" style="width: 100%; height: 200px; object-fit: cover; cursor: pointer;" onclick="openImageViewer('https://t3443930.p.clickup-attachments.com/t3443930/66a97d66-1a1d-41d9-8033-2209a6a266a9/GrantAccess.png', 'GrantAccess.png')">
                                        <div style="padding: 12px; background: #f9fafb; border-top: 1px solid #e5e7eb;">
                                            <div style="font-weight: 600; color: #374151; margin-bottom: 4px;">GrantAccess.png</div>
                                            <a href="https://t3443930.p.clickup-attachments.com/t3443930/66a97d66-1a1d-41d9-8033-2209a6a266a9/GrantAccess.png" target="_blank" style="color: #7c3aed; text-decoration: none; font-size: 0.85rem;">View Full Size ‚Üí</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="Capillary_10">
                    <td><span class="expand-indicator">‚ñ∂</span> 10</td>
                    <td>Discrepancy on new and old ui</td>
                    <td><a href="https://app.clickup.com/t/86d0bw8xy" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-18</td>
                    <td><span class="status status-default">pending (ack)</span></td>
                    <td>Himanshu Mahto</td>
                </tr>
                <tr id="details_Capillary_10" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>Capillary</div>
                                <div><strong>Date:</strong><br>2025-09-18</div>
                                <div><strong>Status:</strong><br>pending (ack)</div>
                                <div><strong>Owner:</strong><br>Himanshu Mahto</div>
                                <div><strong>ClickUp ID:</strong><br>86d0bw8xy</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, Capillary, reported a discrepancy between the new and old UI where CPU/memory limits set by users appeared to revert to older values, and unexpected entries were found in the override section. This issue was observed in their environment, potentially affecting resource management and application performance. The expected behavior was for the user-defined limits to persist without reverting. The anomaly was noted by Bony Mondal, and further investigation was requested by Rauneet Verma, involving permissions for Himanshu Mahto to access the project for deeper analysis.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Bony Mondal observed an anomaly where user-defined CPU/memory limits appeared to revert to older values, and unexpected entries were found in the override section. This was reported to the team for further investigation.<br><br>

2. Rauneet Verma requested Bony Mondal to share relevant URLs in the ticket to facilitate further analysis. This step was crucial to provide context and access to the specific instances where the issue was observed.<br><br>

3. Rauneet Verma also requested permissions for Himanshu Mahto to view the project, indicating a need for deeper access to investigate the configuration and settings that might be causing the discrepancy.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. The team suggested sharing URLs and providing access to the project for Himanshu Mahto to investigate the issue further. This step was necessary to allow a detailed examination of the configurations and settings that might be causing the discrepancy.<br><br>

2. It was recommended to verify the configuration settings and logs to identify any discrepancies between the expected and actual values of CPU/memory limits. This would help in pinpointing the exact cause of the issue.<br><br>

3. The team planned to review the override section entries to determine why unexpected entries appeared and whether they were related to any automated processes or misconfigurations.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The likely root cause of the issue appears to be a configuration or synchronization error where user-defined CPU/memory limits were not being saved correctly, leading to reversion to older values. Additionally, unexpected entries in the override section suggest potential misconfigurations or automated processes that might be altering these settings. Further investigation is needed to confirm the exact cause and ensure that user-defined settings persist as expected.<br><br>
                                </div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìé ClickUp Attachments & Screenshots</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin: 15px 0;">
                                    <div style="border: 2px solid #e5e7eb; border-radius: 8px; overflow: hidden; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <img src="https://t3443930.p.clickup-attachments.com/t3443930/140a20ff-931e-402a-bc4c-fdd57e76f386/image.png" alt="image.png" style="width: 100%; height: 200px; object-fit: cover; cursor: pointer;" onclick="openImageViewer('https://t3443930.p.clickup-attachments.com/t3443930/140a20ff-931e-402a-bc4c-fdd57e76f386/image.png', 'image.png')">
                                        <div style="padding: 12px; background: #f9fafb; border-top: 1px solid #e5e7eb;">
                                            <div style="font-weight: 600; color: #374151; margin-bottom: 4px;">image.png</div>
                                            <a href="https://t3443930.p.clickup-attachments.com/t3443930/140a20ff-931e-402a-bc4c-fdd57e76f386/image.png" target="_blank" style="color: #7c3aed; text-decoration: none; font-size: 0.85rem;">View Full Size ‚Üí</a>
                                        </div>
                                    </div>
                                    <div style="border: 2px solid #e5e7eb; border-radius: 8px; overflow: hidden; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <img src="https://t3443930.p.clickup-attachments.com/t3443930/57d14ac7-126b-42dd-97d7-26dff11529df/Screenshot%202025-09-18%20at%2011.59.58%E2%80%AFAM.png" alt="Screenshot 2025-09-18 at 11.59.58‚ÄØAM.png" style="width: 100%; height: 200px; object-fit: cover; cursor: pointer;" onclick="openImageViewer('https://t3443930.p.clickup-attachments.com/t3443930/57d14ac7-126b-42dd-97d7-26dff11529df/Screenshot%202025-09-18%20at%2011.59.58%E2%80%AFAM.png', 'Screenshot 2025-09-18 at 11.59.58‚ÄØAM.png')">
                                        <div style="padding: 12px; background: #f9fafb; border-top: 1px solid #e5e7eb;">
                                            <div style="font-weight: 600; color: #374151; margin-bottom: 4px;">Screenshot 2025-09-18 at 11.59.58‚ÄØAM.png</div>
                                            <a href="https://t3443930.p.clickup-attachments.com/t3443930/57d14ac7-126b-42dd-97d7-26dff11529df/Screenshot%202025-09-18%20at%2011.59.58%E2%80%AFAM.png" target="_blank" style="color: #7c3aed; text-decoration: none; font-size: 0.85rem;">View Full Size ‚Üí</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="Capillary_11">
                    <td><span class="expand-indicator">‚ñ∂</span> 11</td>
                    <td>USHC Full Release failed<span class="slack-indicator">Slack Thread</span></td>
                    <td><a href="https://app.clickup.com/t/86d09vn93" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-12</td>
                    <td><span class="status status-default">pending (ack)</span></td>
                    <td>Abhisht Bagewadi</td>
                </tr>
                <tr id="details_Capillary_11" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>Capillary</div>
                                <div><strong>Date:</strong><br>2025-09-12</div>
                                <div><strong>Status:</strong><br>pending (ack)</div>
                                <div><strong>Owner:</strong><br>Abhisht Bagewadi</div>
                                <div><strong>ClickUp ID:</strong><br>86d09vn93</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, Capillary, was attempting to complete a full release process for their USHC environment. The expected outcome was a successful deployment, but the process failed due to an AWS ACM certificate being used by other AWS resources, specifically a load balancer. The certificate in question was nearing expiration, and a new certificate had already been created. However, the old certificate was still associated with the load balancer, preventing its deletion and causing the release to fail. This issue was critical as it impacted the deployment timeline and required urgent resolution.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Abhisht Bagewadi initiated the investigation by identifying that the release process could not be completed due to an AWS ACM certificate being used by other AWS resources:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>release process could not be completed because an AWS ACM (Certificate Manager) certificate is currently being used by other AWS resources.</code></pre>
</div>
   This was confirmed by checking the certificate details in the AWS Console.<br><br>

2. Nikhil Tidke noted that the certificate was set to expire in 11 days and a new certificate had already been created:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>Actually this certificate is going to expire in 11 days and a new certificate is already created.</code></pre>
</div>
   This indicated that the new certificate should have been associated automatically, but it wasn't.<br><br>

3. Abhisht Bagewadi provided a detailed action plan to address the issue, which included logging into the AWS Console, navigating to the Certificate Manager, and reviewing the associated resources:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>Required Actions :
   1. Log in to the AWS Console.<br>
   2. Go to Certificate Manager in the us-east-1 region.<br>
   3. Locate the certificate with ID 701b673c-9f25-4030-8cad-22420d743184.<br>
   4. Open the certificate details.<br>
   5. Review the Associated resources section to identify which services are using it.</code></pre><br>
</div>

4. Ishaan Kalra inquired about the load balancer's subnet attachment to understand if it was contributing to the issue, but this required further clarification from Nikhil Tidke.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. Nikhil Tidke manually updated the new SSL certificate from the AWS Console, ensuring that the new certificate was in place for future releases:<br><br>
   <div class="code-block-wrapper">
<div class="code-header">üìù CODE</div>
<pre class="code-block"><code>We have manully updated the New SSL certificate from AWS Console. Now in next release our old should get deleted.</code></pre>
</div>
   This step was crucial to ensure the old certificate would be dissociated and deleted in the next release cycle.<br><br>

2. Ishaan Kalra suggested detaching the old certificate from the load balancer manually to resolve the immediate issue. This was a temporary workaround to allow the release to proceed while a more permanent solution was planned.<br><br>

3. The team planned to migrate the legacy 'tools' resource to the latest version to prevent similar issues in the future, as the legacy setup was causing complications with the certificate association.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The issue appears to have been caused by an AWS ACM certificate (ID: 701b673c-9f25-4030-8cad-22420d743184) that was still attached to a load balancer, preventing its deletion during the release process. This certificate was nearing expiration, and although a new certificate had been created, it was not automatically associated with the load balancer as expected. The root cause was likely due to the legacy configuration of the 'tools' resource, which did not facilitate the automatic update of the certificate. Further investigation into the automation scripts and resource configurations is needed to confirm this hypothesis and prevent recurrence.<br><br>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="Capillary_12">
                    <td><span class="expand-indicator">‚ñ∂</span> 12</td>
                    <td>USHC Plan Release failed</td>
                    <td><a href="https://app.clickup.com/t/86d09ue6c" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-12</td>
                    <td><span class="status status-default">invalid</span></td>
                    <td>Unassigned</td>
                </tr>
                <tr id="details_Capillary_12" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>Capillary</div>
                                <div><strong>Date:</strong><br>2025-09-12</div>
                                <div><strong>Status:</strong><br>invalid</div>
                                <div><strong>Owner:</strong><br>Unassigned</div>
                                <div><strong>ClickUp ID:</strong><br>86d09ue6c</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, Capillary, was attempting to execute a USHC Plan Release, which is a critical operation in their environment. The expected outcome was a successful deployment without any errors. However, the process failed, leading to an urgent ticket being raised. The ticket was marked as 'invalid' after the issue was identified internally by the team. The environment involved was likely a production or staging setup, given the urgency and the nature of the task. The conversation indicates that the issue was recognized and resolved internally, as suggested by the brief communication from Nikhil Tidke.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Nikhil Tidke acknowledged the issue internally and indicated that it should be ignored. This suggests that the problem was identified and understood by the team without requiring further external debugging steps.<br><br>

2. No specific debugging commands or logs were shared in the conversation, indicating that the resolution was handled internally, possibly through known procedures or configurations that were not documented in the shared conversation.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. Nikhil Tidke communicated that the issue should be ignored, implying that the resolution was achieved internally. This suggests that the team identified the root cause and resolved it without needing further external intervention or detailed documentation.<br><br>

2. No explicit resolution steps were documented in the conversation, indicating that the resolution was likely straightforward or involved internal processes that were not shared in the conversation.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The root cause of the issue appears to be an internal misconfiguration or a known issue that the team was already aware of. Nikhil Tidke's comment to "Please ignore" suggests that the problem was either not critical or was resolved through internal processes that did not require further external documentation. The lack of detailed debugging or resolution steps in the conversation indicates that the team had prior knowledge or a quick fix for the issue. Further investigation or documentation would be needed to confirm the exact technical details.<br><br>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="Capillary_13">
                    <td><span class="expand-indicator">‚ñ∂</span> 13</td>
                    <td>Facing Issue with Custom Role assigned to a User while rolling restart</td>
                    <td><a href="https://app.clickup.com/t/86d09gu5m" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-11</td>
                    <td><span class="status status-default">as designed</span></td>
                    <td>Debarshi Mullick</td>
                </tr>
                <tr id="details_Capillary_13" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>Capillary</div>
                                <div><strong>Date:</strong><br>2025-09-11</div>
                                <div><strong>Status:</strong><br>as designed</div>
                                <div><strong>Owner:</strong><br>Debarshi Mullick</div>
                                <div><strong>ClickUp ID:</strong><br>86d09gu5m</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, Capillary, was attempting to perform a rolling restart of a Kubernetes pod using a custom role. The expectation was that the assigned role would allow the restart operation. However, the operation failed because the Kubernetes reader role lacked the necessary update permissions required for a rollout restart. This issue was identified in a high-priority ticket involving engineers Nikhil Tidke, Samarthya Gupta, and Debarshi Mullick. The environment involved Kubernetes, and the impact was that the user could not perform the intended restart operation due to insufficient permissions.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. **Debarshi Mullick** initiated the investigation by acknowledging the issue and starting to look into it.<br><br>

2. **Samarthya Gupta** identified that the problem was related to the Kubernetes reader role, which lacked the <code class="inline-code">update</code> permission necessary for performing a rollout restart. This was communicated to **Nikhil Tidke**.<br>

3. **Samarthya Gupta** suggested creating another Kubernetes role or providing the developer (k8s debugger) permission to resolve the issue. This was a recommendation to ensure the necessary permissions were available for the restart operation.<br><br>

4. **Nikhil Tidke** inquired about the process of creating another role and the specific permissions associated with the k8s debugger role, indicating a need for further clarification on role capabilities.<br><br>

5. **Nikhil Tidke** also questioned the significance of the "Application Rollout Checkbox" in the UI, which was assumed to allow users to perform restarts when selected, even with the reader K8s Role. This highlighted a potential misunderstanding of UI functionalities.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. **Samarthya Gupta** recommended creating a new Kubernetes role with the necessary <code class="inline-code">update</code> permissions or assigning the developer (k8s debugger) permission to the user. This step was suggested to ensure that the user could perform the rollout restart without encountering permission issues.<br>

2. **Nikhil Tidke** was advised to explore the creation of a new role or modification of existing roles to include the required permissions. This involved understanding the permissions associated with the k8s debugger role and potentially adjusting the role configurations.<br><br>

3. The team discussed the significance of the "Application Rollout Checkbox" in the UI, which was initially misunderstood to grant restart capabilities. Clarifying this functionality was part of ensuring that users have the correct understanding of UI elements and their permissions.<br><br>

4. The customer was advised to implement these changes on their side, as the resolution involved modifying role permissions, which is a customer-side action. The status of the ticket was marked as "as designed," indicating that the system was functioning as intended, but user roles needed adjustment.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The root cause of the issue was the insufficient permissions associated with the Kubernetes reader role, which lacked the <code class="inline-code">update</code> permission necessary for performing a rollout restart. This was identified through the team's analysis of the role's capabilities and the requirements for the restart operation. The misunderstanding regarding the "Application Rollout Checkbox" in the UI further contributed to the confusion, as it was incorrectly assumed to allow restarts with the reader role. The issue was resolved by recommending the creation of a new role or assigning the k8s debugger permission, which includes the necessary update capabilities.<br>
                                </div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìé ClickUp Attachments & Screenshots</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin: 15px 0;">
                                    <div style="border: 2px solid #e5e7eb; border-radius: 8px; overflow: hidden; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <img src="https://t3443930.p.clickup-attachments.com/t3443930/64fa5e22-ad8d-4c97-884c-d081c4db617b/image-20250910-095610.png" alt="image-20250910-095610.png" style="width: 100%; height: 200px; object-fit: cover; cursor: pointer;" onclick="openImageViewer('https://t3443930.p.clickup-attachments.com/t3443930/64fa5e22-ad8d-4c97-884c-d081c4db617b/image-20250910-095610.png', 'image-20250910-095610.png')">
                                        <div style="padding: 12px; background: #f9fafb; border-top: 1px solid #e5e7eb;">
                                            <div style="font-weight: 600; color: #374151; margin-bottom: 4px;">image-20250910-095610.png</div>
                                            <a href="https://t3443930.p.clickup-attachments.com/t3443930/64fa5e22-ad8d-4c97-884c-d081c4db617b/image-20250910-095610.png" target="_blank" style="color: #7c3aed; text-decoration: none; font-size: 0.85rem;">View Full Size ‚Üí</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="expandable" data-ticket-id="Capillary_14">
                    <td><span class="expand-indicator">‚ñ∂</span> 14</td>
                    <td>Increased costs for EC2 instances<span class="slack-indicator">Slack Thread</span></td>
                    <td><a href="https://app.clickup.com/t/86d08p5g5" 
                           style="color: #7c3aed; text-decoration: none; padding: 5px 12px; 
                                  border: 1px solid #7c3aed; border-radius: 6px; display: inline-block; font-size: 0.85rem;"
                           target="_blank" onclick="event.stopPropagation()">View</a></td>
                    <td>2025-09-09</td>
                    <td><span class="status status-open">Open</span></td>
                    <td>Unassigned</td>
                </tr>
                <tr id="details_Capillary_14" style="display: none;">
                    <td colspan="6" style="padding: 0;">
                        <div style="background: #f9fafb; padding: 20px 60px; border-left: 4px solid #7c3aed;">
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; 
                                        padding: 15px; background: white; border-radius: 6px;">
                                <div><strong>Customer:</strong><br>Capillary</div>
                                <div><strong>Date:</strong><br>2025-09-09</div>
                                <div><strong>Status:</strong><br>Open</div>
                                <div><strong>Owner:</strong><br>Unassigned</div>
                                <div><strong>ClickUp ID:</strong><br>86d08p5g5</div>
                                <div><strong>Analysis:</strong><br>‚úÖ AI Generated</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üìã Summary of the Issue</h4>
                                <div class="rca-content-box">
                                    The customer, Capillary, reported a significant increase in their EC2 instance costs, rising from $1.4k to $2.5k in August. This unexpected cost surge prompted an investigation to determine the cause and identify any potential misconfigurations or usage anomalies. The environment in question involves AWS EC2 services, and the impact is primarily financial, affecting the customer's budget and resource allocation. The issue was flagged as high priority, necessitating a prompt and thorough analysis to mitigate further financial impact.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üîç Steps to Debug</h4>
                                <div class="rca-content-box">
                                    1. Prashant Dhanke initiated the investigation by reaching out to Sreejith S and Pallav Kumar to confirm if the cost increase issue was still present. This step was crucial to ensure that the problem was ongoing and required immediate attention.<br><br>

2. The team reviewed the AWS billing dashboard to identify any anomalies or unexpected charges that could explain the cost increase. This involved checking for any new instances or changes in instance types that might have contributed to the higher costs.<br><br>

3. The team suggested examining the EC2 usage patterns and configurations to identify any potential inefficiencies or misconfigurations. This included checking for instances running in non-optimal states or regions that might incur higher charges.<br><br>

4. It was recommended to analyze the historical usage data to compare the current month's usage with previous months. This would help in identifying any sudden spikes in usage that could correlate with the increased costs.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">‚úÖ Steps to Resolution</h4>
                                <div class="rca-content-box">
                                    1. The team recommended optimizing the EC2 instance configurations by reviewing the instance types and sizes to ensure they match the workload requirements. This step aims to reduce unnecessary resource allocation and associated costs.<br><br>

2. It was suggested to implement cost monitoring and alerting mechanisms using AWS Cost Explorer and CloudWatch. This would provide real-time insights into cost trends and enable proactive management of resource usage.<br><br>

3. The team advised conducting a thorough audit of all running instances to identify any that could be terminated or downsized. This action would directly address the cost increase by eliminating or reducing unnecessary resource consumption.<br><br>

4. Customer was advised to review and adjust any automated scaling policies that might be inadvertently increasing resource usage during off-peak times.<br><br>
                                </div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #1f2937;">üéØ Root Cause Analysis</h4>
                                <div class="rca-content-box">
                                    The likely root cause of the increased EC2 costs appears to be a combination of misconfigured instance types and potentially inefficient usage patterns. The investigation suggested that there might have been instances running in higher-cost regions or with larger instance sizes than necessary. Additionally, the absence of effective cost monitoring and alerting mechanisms may have delayed the detection of these inefficiencies. Further investigation and optimization of the EC2 configurations are needed to confirm and address these issues.<br><br>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr></table></div>
    </div>
    
    <script>
        // Ensure all details are expanded when printing
        window.addEventListener('beforeprint', function() {
            // Expand all detail rows before printing
            const detailRows = document.querySelectorAll('[id^="details_"]');
            detailRows.forEach(row => {
                row.style.display = 'table-row';
            });
            
            // Hide expand indicators
            const indicators = document.querySelectorAll('.expand-indicator');
            indicators.forEach(indicator => {
                indicator.style.display = 'none';
            });
        });
        
        // Optional: Restore collapsed state after printing (commented out to keep expanded)
        // window.addEventListener('afterprint', function() {
        //     const detailRows = document.querySelectorAll('[id^="details_"]');
        //     detailRows.forEach(row => {
        //         row.style.display = 'none';
        //     });
        // });
        
        function toggleDetails(ticketId) {
            const detailsRow = document.getElementById('details_' + ticketId);
            const clickedRow = detailsRow.previousElementSibling;
            const indicator = clickedRow.querySelector('.expand-indicator');
            
            if (detailsRow.style.display === 'table-row') {
                detailsRow.style.display = 'none';
                indicator.innerHTML = '‚ñ∂';
                clickedRow.classList.remove('expanded');
            } else {
                // Close all other expanded rows
                document.querySelectorAll('[id^="details_"]').forEach(row => {
                    row.style.display = 'none';
                    if (row.previousElementSibling) {
                        row.previousElementSibling.classList.remove('expanded');
                        row.previousElementSibling.querySelector('.expand-indicator').innerHTML = '‚ñ∂';
                    }
                });
                
                detailsRow.style.display = 'table-row';
                indicator.innerHTML = '‚ñº';
                clickedRow.classList.add('expanded');
            }
        }
        
        let lastEnterTime = 0;

        function performSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            const sections = document.querySelectorAll('.customer-section');
            let totalVisible = 0;

            sections.forEach(section => {
                const customerName = section.querySelector('h2').textContent.toLowerCase();
                const rows = section.querySelectorAll('tr.expandable');
                let hasVisibleRows = false;

                rows.forEach(row => {
                    const cells = row.cells;
                    const title = cells[1] ? cells[1].textContent.toLowerCase() : '';
                    const clickupId = cells[2] ? cells[2].textContent.toLowerCase() : '';
                    const date = cells[3] ? cells[3].textContent.toLowerCase() : '';
                    const status = cells[4] ? cells[4].textContent.toLowerCase() : '';
                    const owner = cells[5] ? cells[5].textContent.toLowerCase() : '';

                    const shouldShow = searchTerm === '' ||
                                     title.includes(searchTerm) ||
                                     customerName.includes(searchTerm) ||
                                     clickupId.includes(searchTerm) ||
                                     date.includes(searchTerm) ||
                                     status.includes(searchTerm) ||
                                     owner.includes(searchTerm);

                    row.style.display = shouldShow ? '' : 'none';
                    if (shouldShow) {
                        hasVisibleRows = true;
                        totalVisible++;
                    }

                    // Hide details row if main row is hidden
                    const detailsRow = row.nextElementSibling;
                    if (detailsRow && detailsRow.id && detailsRow.id.startsWith('details_')) {
                        detailsRow.style.display = shouldShow ? '' : 'none';
                    }
                });

                section.style.display = hasVisibleRows ? '' : 'none';
            });

            updateSearchStatus(searchTerm ? `Found ${totalVisible} result(s)` : '');
        }

        function clearSearch() {
            document.getElementById('searchInput').value = '';
            performSearch();
            updateSearchStatus('Search cleared');
        }

        function updateSearchStatus(message) {
            let statusDiv = document.getElementById('searchStatus');
            if (!statusDiv) {
                statusDiv = document.createElement('div');
                statusDiv.id = 'searchStatus';
                statusDiv.style.cssText = 'text-align: center; padding: 10px; color: #7c3aed; font-size: 14px;';
                document.querySelector('.search-section').appendChild(statusDiv);
            }
            statusDiv.textContent = message;
            if (message) {
                setTimeout(() => { statusDiv.textContent = ''; }, 2000);
            }
        }
        
        // Enhanced keyboard support
        document.getElementById('searchInput').addEventListener('keyup', function(event) {
            const currentTime = Date.now();

            if (event.key === 'Enter') {
                if (this.value === '' && currentTime - lastEnterTime < 500) {
                    // Double-Enter on empty field clears any filters
                    clearSearch();
                    lastEnterTime = 0;
                } else {
                    performSearch();
                    lastEnterTime = currentTime;
                }
            } else if (event.key === 'Escape') {
                clearSearch();
            }
        });

        // Real-time search as you type
        document.getElementById('searchInput').addEventListener('input', function() {
            performSearch();
        });

        // Clear on double-click
        document.getElementById('searchInput').addEventListener('dblclick', function() {
            clearSearch();
        });

        // Cloud URLs will be injected here after upload
        window.reportCloudUrls = {};

        // Share functionality
        function shareReport() {
            console.log('Share button clicked!'); // Debug log

            const modal = document.getElementById('shareModal');
            const urlInput = document.getElementById('shareUrl');

            if (!modal) {
                console.error('Share modal not found!');
                alert('Error: Share modal not found. Please refresh the page.');
                return;
            }

            if (!urlInput) {
                console.error('Share URL input not found!');
                alert('Error: Share URL input not found. Please refresh the page.');
                return;
            }

            // Get the current page URL (or use the cloud URL if available)
            let shareUrl = window.location.href;

            // Check if we have cloud URLs stored in the page
            const cloudUrls = window.reportCloudUrls || {};
            console.log('Available cloud URLs:', cloudUrls); // Debug log

            // Prefer GitHub Pages, then Gist, then regular preview, then transfer.sh, then local
            if (cloudUrls.github_repo && cloudUrls.github_repo.github_pages_url) {
                shareUrl = cloudUrls.github_repo.github_pages_url;
                console.log('Using GitHub Pages URL (best option)');
            } else if (cloudUrls.github_gist && cloudUrls.github_gist.preview_url) {
                shareUrl = cloudUrls.github_gist.preview_url;
                console.log('Using GitHub gist preview URL');
            } else if (cloudUrls.github_repo && cloudUrls.github_repo.preview_url) {
                shareUrl = cloudUrls.github_repo.preview_url;
                console.log('Using GitHub repo preview URL (limited JavaScript)');
            } else if (cloudUrls.transfer_sh) {
                shareUrl = cloudUrls.transfer_sh;
                console.log('Using transfer.sh URL');
            } else {
                console.log('Using local file URL');
            }

            urlInput.value = shareUrl;

            // Also populate the backup URL (HTML Preview)
            const backupUrlInput = document.getElementById('shareUrlBackup');
            if (backupUrlInput) {
                let backupUrl = '';
                if (cloudUrls.github_repo && cloudUrls.github_repo.preview_url) {
                    backupUrl = cloudUrls.github_repo.preview_url;
                } else if (cloudUrls.github_gist && cloudUrls.github_gist.preview_url) {
                    backupUrl = cloudUrls.github_gist.preview_url;
                } else {
                    // Fallback: construct htmlpreview URL from current location
                    const currentUrl = window.location.href;
                    if (currentUrl.includes('github.io')) {
                        // Convert GitHub Pages URL to htmlpreview URL
                        const rawUrl = currentUrl.replace('abhishub-12.github.io/RCA-REPORTS/', 'raw.githubusercontent.com/AbhisHub-12/RCA-REPORTS/main/');
                        backupUrl = 'https://htmlpreview.github.io/?' + rawUrl;
                    } else {
                        backupUrl = 'HTML Preview not available for local files';
                    }
                }
                backupUrlInput.value = backupUrl;

                // Hide backup section if not available
                const backupSection = document.getElementById('backupSection');
                if (backupSection) {
                    if (backupUrl === 'HTML Preview not available for local files') {
                        backupSection.style.display = 'none';
                    } else {
                        backupSection.style.display = 'block';
                    }
                }
            }

            modal.style.display = 'block';
            console.log('Modal should now be visible'); // Debug log
        }

        function closeShareModal() {
            document.getElementById('shareModal').style.display = 'none';
            document.getElementById('copySuccess').style.display = 'none';
        }

        function copyShareLink() {
            const urlInput = document.getElementById('shareUrl');
            const copySuccess = document.getElementById('copySuccess');

            // Select and copy the text
            urlInput.select();
            urlInput.setSelectionRange(0, 99999); // For mobile devices

            try {
                document.execCommand('copy');
                copySuccess.style.display = 'block';

                // Hide success message after 3 seconds
                setTimeout(() => {
                    copySuccess.style.display = 'none';
                }, 3000);
            } catch (err) {
                // Fallback for modern browsers
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(urlInput.value).then(() => {
                        copySuccess.style.display = 'block';
                        setTimeout(() => {
                            copySuccess.style.display = 'none';
                        }, 3000);
                    });
                }
            }
        }

        function shareViaEmail() {
            const url = document.getElementById('shareUrl').value;
            const subject = encodeURIComponent('RCA Report - ' + document.title);
            const body = encodeURIComponent('Here is the RCA report:\n\n' + url);
            window.location.href = 'mailto:?subject=' + subject + '&body=' + body;
        }

        function shareViaSlack() {
            const url = document.getElementById('shareUrl').value;
            const text = encodeURIComponent('RCA Report: ' + url);
            // Open Slack's share URL (user needs to be logged in)
            window.open('https://slack.com/intl/en-in/share?url=' + encodeURIComponent(url), '_blank');
        }

        function shareViaTeams() {
            const url = document.getElementById('shareUrl').value;
            const text = encodeURIComponent('Check out this RCA Report');
            // Open Teams share dialog
            window.open('https://teams.microsoft.com/share?href=' + encodeURIComponent(url) + '&text=' + text, '_blank');
        }

        function shareViaWhatsApp() {
            const url = document.getElementById('shareUrl').value;
            const text = encodeURIComponent('RCA Report: ' + url);
            // Open WhatsApp with pre-filled message
            window.open('https://wa.me/?text=' + text, '_blank');
        }

        function copyBackupLink() {
            const backupUrlInput = document.getElementById('shareUrlBackup');
            // Select and copy the text
            backupUrlInput.select();
            backupUrlInput.setSelectionRange(0, 99999); // For mobile devices
            try {
                document.execCommand('copy');
                // Show temporary success indicator
                const button = document.getElementById('copyBackupLinkBtn');
                const originalText = button.innerHTML;
                button.innerHTML = '‚úÖ Copied!';
                button.style.background = '#10b981';
                // Reset after 2 seconds
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.style.background = '#059669';
                }, 2000);
            } catch (err) {
                console.error('Failed to copy backup link: ', err);
                alert('Failed to copy to clipboard. Please copy manually.');
            }
        }

        // Image Viewer Functions
        function openImageViewer(imageUrl, imageTitle) {
            const modal = document.getElementById('imageViewerModal');
            const image = document.getElementById('imageViewerImage');
            const title = document.getElementById('imageViewerTitle');

            image.src = imageUrl;
            image.alt = imageTitle;
            title.textContent = imageTitle;
            modal.style.display = 'block';

            // Prevent body scroll when modal is open
            document.body.style.overflow = 'hidden';
        }

        function closeImageViewer() {
            const modal = document.getElementById('imageViewerModal');
            modal.style.display = 'none';

            // Restore body scroll
            document.body.style.overflow = 'auto';
        }

        // Close image viewer with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeImageViewer();
            }
        });

        // Close modal when clicking outside
        document.getElementById('shareModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeShareModal();
            }
        });

        // Add keyboard shortcut for share (Ctrl+Shift+S)
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.shiftKey && e.key === 'S') {
                e.preventDefault();
                shareReport();
            }
        });

        // Enhanced debugging for GitHub Pages
        console.log('üîß SCRIPT LOADING: JavaScript file started');
        console.log('üåê ENVIRONMENT:', window.location.href);
        console.log('üìç USER AGENT:', navigator.userAgent);

        // Check for Content Security Policy issues
        if (typeof window.CSP !== 'undefined') {
            console.log('‚ö†Ô∏è CSP DETECTED:', window.CSP);
        }

        // Validate all functions are loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ DOM Content Loaded');
            console.log('‚úÖ ShareReport function:', typeof shareReport);
            console.log('‚úÖ ToggleDetails function:', typeof toggleDetails);
            console.log('‚úÖ Share modal element:', document.getElementById('shareModal') ? 'Found' : 'Not Found');
            console.log('‚úÖ Cloud URLs:', window.reportCloudUrls);

            // Test basic DOM manipulation
            try {
                const testElement = document.querySelector('.expandable');
                if (testElement) {
                    console.log('‚úÖ EXPANDABLE ELEMENTS FOUND:', document.querySelectorAll('.expandable').length);
                } else {
                    console.log('‚ùå NO EXPANDABLE ELEMENTS FOUND');
                }
            } catch (error) {
                console.error('‚ùå DOM QUERY ERROR:', error);
            }

            // Test event listener attachment
            try {
                const shareBtn = document.getElementById('shareReportBtn');
                if (shareBtn) {
                    console.log('‚úÖ SHARE BUTTON FOUND, ATTACHING LISTENERS');
                } else {
                    console.log('‚ùå SHARE BUTTON NOT FOUND');
                }
            } catch (error) {
                console.error('‚ùå EVENT LISTENER ERROR:', error);
            }

            // Add event listeners for ticket expansion (GitHub Pages compatible)
            document.querySelectorAll('.expandable').forEach(row => {
                row.addEventListener('click', function() {
                    const ticketId = this.getAttribute('data-ticket-id');
                    if (ticketId) {
                        toggleDetails(ticketId);
                    }
                });
            });

            // Add event listener for share button (GitHub Pages compatible)
            const shareBtn = document.getElementById('shareReportBtn');
            if (shareBtn) {
                shareBtn.addEventListener('click', function() {
                    console.log('Share button clicked via event listener!');
                    shareReport();
                });
            }

            // Add event listener for print button (GitHub Pages compatible)
            const printBtn = document.getElementById('printBtn');
            if (printBtn) {
                printBtn.addEventListener('click', function() {
                    window.print();
                });
            }

            // Add event listeners for modal buttons (GitHub Pages compatible)
            const closeModalBtn = document.getElementById('closeModalBtn');
            if (closeModalBtn) {
                closeModalBtn.addEventListener('click', closeShareModal);
            }

            const copyLinkBtn = document.getElementById('copyLinkBtn');
            if (copyLinkBtn) {
                copyLinkBtn.addEventListener('click', copyShareLink);
            }

            const copyBackupLinkBtn = document.getElementById('copyBackupLinkBtn');
            if (copyBackupLinkBtn) {
                copyBackupLinkBtn.addEventListener('click', copyBackupLink);
            }

            const shareEmailBtn = document.getElementById('shareEmailBtn');
            if (shareEmailBtn) {
                shareEmailBtn.addEventListener('click', shareViaEmail);
            }

            const shareSlackBtn = document.getElementById('shareSlackBtn');
            if (shareSlackBtn) {
                shareSlackBtn.addEventListener('click', shareViaSlack);
            }

            const shareTeamsBtn = document.getElementById('shareTeamsBtn');
            if (shareTeamsBtn) {
                shareTeamsBtn.addEventListener('click', shareViaTeams);
            }

            const shareWhatsAppBtn = document.getElementById('shareWhatsAppBtn');
            if (shareWhatsAppBtn) {
                shareWhatsAppBtn.addEventListener('click', shareViaWhatsApp);
            }

            // Add event listeners for search buttons (GitHub Pages compatible)
            const searchBtn = document.getElementById('searchBtn');
            if (searchBtn) {
                searchBtn.addEventListener('click', performSearch);
            }

            const clearBtn = document.getElementById('clearBtn');
            if (clearBtn) {
                clearBtn.addEventListener('click', clearSearch);
            }
        });
    </script>
</body>
</html>